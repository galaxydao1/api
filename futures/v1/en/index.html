
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Bost API documentation(v1)</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sa, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-d7ff0a2f.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-628c1a7f.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-e033bdd3.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[&quot;javascript&quot;,&quot;python&quot;,&quot;csharp&quot;]">
    <a href="#" id="nav-button">
      <span>
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <header>
      <div class="flex_box">
        <img src="images/logo-407dc1bf.png" class="logo" id="trade-planet-logo" alt="" />
        <div class="nav_box">
          <span class="nav-select" id="spot-class-current">
            <a href="/api/spot/v1/zh/" id="spot-txt"></a>
          </span>
          <span class="nav-select" id="future-class-current">
            <a href="/api/futures/v1/zh/" id="future-txt"></a>
          </span>
        </div>
      </div>
      <a href="/api/spot/v1/zh/" class="lang" id="lang_box1"></a>
      <a href="/api/spot/v1/zh/" class="lang" id="lang_box2"></a>
    </header>
    <div class="toc-wrapper">
        <div class="lang-selector">
              <a href="#" data-language-name="javascript">javascript</a>
              <a href="#" data-language-name="python">python</a>
              <a href="#" data-language-name="csharp">csharp</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#base-usdt-contract" class="toc-h1 toc-link" data-title="Base-USDT contract">Base-USDT contract</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#list-of-alternate-api-domains" class="toc-h2 toc-link" data-title="List of alternate API domains">List of alternate API domains</a>
                  </li>
                  <li>
                    <a href="#1-signature-interface-request-method" class="toc-h2 toc-link" data-title="1.Signature interface request method">1.Signature interface request method</a>
                  </li>
                  <li>
                    <a href="#2-fund-transfer" class="toc-h2 toc-link" data-title="2.Fund transfer">2.Fund transfer</a>
                  </li>
                  <li>
                    <a href="#3-place-order" class="toc-h2 toc-link" data-title="3.Place order">3.Place order</a>
                  </li>
                  <li>
                    <a href="#4-cancel-order" class="toc-h2 toc-link" data-title="4.Cancel order">4.Cancel order</a>
                  </li>
                  <li>
                    <a href="#5-batch-cancellation" class="toc-h2 toc-link" data-title="5.Batch cancellation">5.Batch cancellation</a>
                  </li>
                  <li>
                    <a href="#6-cancel-all-orders" class="toc-h2 toc-link" data-title="6.Cancel all orders">6.Cancel all orders</a>
                  </li>
                  <li>
                    <a href="#7-place-stop-profit-stop-loss-order" class="toc-h2 toc-link" data-title="7.Place Stop-profit Stop-loss Order">7.Place Stop-profit Stop-loss Order</a>
                  </li>
                  <li>
                    <a href="#8-list-stop-profit-stop-loss-order" class="toc-h2 toc-link" data-title="8.list Stop-profit Stop-loss Order">8.list Stop-profit Stop-loss Order</a>
                  </li>
                  <li>
                    <a href="#9-cancel-stop-profit-stop-loss-order" class="toc-h2 toc-link" data-title="9.Cancel Stop-profit Stop-loss Order">9.Cancel Stop-profit Stop-loss Order</a>
                  </li>
                  <li>
                    <a href="#10-cancel-all-stop-profit-stop-loss-order" class="toc-h2 toc-link" data-title="10.Cancel all Stop-profit Stop-loss Order">10.Cancel all Stop-profit Stop-loss Order</a>
                  </li>
                  <li>
                    <a href="#11-adjust-margin-on-a-fixed-position" class="toc-h2 toc-link" data-title="11.Adjust margin on a fixed position">11.Adjust margin on a fixed position</a>
                  </li>
                  <li>
                    <a href="#12-adjust-position-mode-and-leverage" class="toc-h2 toc-link" data-title="12.Adjust position mode and leverage">12.Adjust position mode and leverage</a>
                  </li>
                  <li>
                    <a href="#13-query-assets" class="toc-h2 toc-link" data-title="13.Query assets">13.Query assets</a>
                  </li>
                  <li>
                    <a href="#14-query-position" class="toc-h2 toc-link" data-title="14.Query position">14.Query position</a>
                  </li>
                  <li>
                    <a href="#15-query-order-list" class="toc-h2 toc-link" data-title="15.Query order list">15.Query order list</a>
                  </li>
                  <li>
                    <a href="#16-query-order" class="toc-h2 toc-link" data-title="16.Query order">16.Query order</a>
                  </li>
                  <li>
                    <a href="#17-batch-query-order" class="toc-h2 toc-link" data-title="17. Batch query order">17. Batch query order</a>
                  </li>
                  <li>
                    <a href="#18-query-order-list-based-on-clientoid" class="toc-h2 toc-link" data-title="18.Query order list based on clientoid">18.Query order list based on clientoid</a>
                  </li>
                  <li>
                    <a href="#19-get-server-time" class="toc-h2 toc-link" data-title="19.Get server time">19.Get server time</a>
                  </li>
                  <li>
                    <a href="#20-qeury-position-holding-changed-records" class="toc-h2 toc-link" data-title="20.Qeury position holding changed records">20.Qeury position holding changed records</a>
                  </li>
                  <li>
                    <a href="#21-query-order-deals-detail" class="toc-h2 toc-link" data-title="21.Query order deals detail">21.Query order deals detail</a>
                  </li>
                  <li>
                    <a href="#22-query-historical-orders" class="toc-h2 toc-link" data-title="22.Query historical orders">22.Query historical orders</a>
                  </li>
                  <li>
                    <a href="#23-query-order" class="toc-h2 toc-link" data-title="23.Query order">23.Query order</a>
                  </li>
                  <li>
                    <a href="#24-qeury-fund-fee-rate" class="toc-h2 toc-link" data-title="24.Qeury fund fee rate">24.Qeury fund fee rate</a>
                  </li>
                  <li>
                    <a href="#25-qeury-tag-price" class="toc-h2 toc-link" data-title="25.Qeury tag price">25.Qeury tag price</a>
                  </li>
                  <li>
                    <a href="#26-query-basic-contract-information" class="toc-h2 toc-link" data-title="26.Query basic contract information">26.Query basic contract information</a>
                  </li>
                  <li>
                    <a href="#27-query-accuracy-configuration" class="toc-h2 toc-link" data-title="27.Query accuracy configuration">27.Query accuracy configuration</a>
                  </li>
                  <li>
                    <a href="#28-query-kline" class="toc-h2 toc-link" data-title="28.Query Kline">28.Query Kline</a>
                  </li>
                  <li>
                    <a href="#29-query-market-depth" class="toc-h2 toc-link" data-title="29.Query market depth">29.Query market depth</a>
                  </li>
                  <li>
                    <a href="#30-subscription-to-kline" class="toc-h2 toc-link" data-title="30.Subscription to Kline">30.Subscription to Kline</a>
                  </li>
                  <li>
                    <a href="#31-subscription-to-tag-price" class="toc-h2 toc-link" data-title="31.Subscription to Tag price">31.Subscription to Tag price</a>
                  </li>
                  <li>
                    <a href="#32-subscription-to-market-depth" class="toc-h2 toc-link" data-title="32.Subscription to Market depth">32.Subscription to Market depth</a>
                  </li>
                  <li>
                    <a href="#33-subscription-to-deals-detail" class="toc-h2 toc-link" data-title="33.Subscription to deals detail">33.Subscription to deals detail</a>
                  </li>
                  <li>
                    <a href="#34-subscription-to-ticker" class="toc-h2 toc-link" data-title="34.Subscription to ticker">34.Subscription to ticker</a>
                  </li>
                  <li>
                    <a href="#35-subscription-to-user-data" class="toc-h2 toc-link" data-title="35.Subscription to user data">35.Subscription to user data</a>
                  </li>
                  <li>
                    <a href="#36-get-assets-from-subscribed-user-data" class="toc-h2 toc-link" data-title="36.Get assets from subscribed user data">36.Get assets from subscribed user data</a>
                  </li>
                  <li>
                    <a href="#37-get-position-from-subscribed-user-data" class="toc-h2 toc-link" data-title="37.Get position from subscribed user data">37.Get position from subscribed user data</a>
                  </li>
                  <li>
                    <a href="#38-get-order-from-subscribed-user-data" class="toc-h2 toc-link" data-title="38.Get order from subscribed user data">38.Get order from subscribed user data</a>
                  </li>
                  <li>
                    <a href="#39-get-deals-detail-from-subscribed-user-data" class="toc-h2 toc-link" data-title="39.Get deals detail from subscribed user data">39.Get deals detail from subscribed user data</a>
                  </li>
                  <li>
                    <a href="#40-get-passive-changes-in-positions-from-subscribed-user-data" class="toc-h2 toc-link" data-title="40.Get passive changes in positions from subscribed user data">40.Get passive changes in positions from subscribed user data</a>
                  </li>
                  <li>
                    <a href="#41-get-stop-profit-stop-loss-order-from-subscribed-user-data" class="toc-h2 toc-link" data-title="41.Get Stop-profit Stop-loss Order from subscribed user data">41.Get Stop-profit Stop-loss Order from subscribed user data</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#044106d39a" class="toc-h2 toc-link" data-title="エラーコード">エラーコード</a>
                  </li>
              </ul>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://www.trade-planets.com'>Start trading</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='base-usdt-contract'>Base-USDT contract</h1><h2 id='list-of-alternate-api-domains'>List of alternate API domains</h2>
<p><a href="https://api.trade-planets.com/v1/public/queryApiDomain">https://api.trade-planets.com/v1/public/queryApiDomain</a></p>
<h2 id='1-signature-interface-request-method'>1.Signature interface request method</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span> <span class="c1">// 1.Current timestamp</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span> <span class="c1">// 2.Requested parameters</span>
    <span class="dl">"</span><span class="s2">amount</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">0.01</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">symbol</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">USDT</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span><span class="mi">0</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">strParam</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">// 2.Formatting parameters</span>

<span class="kd">let</span> <span class="nx">strToSign</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">strParam</span><span class="p">;</span> <span class="c1">// 3.This is the string that needs to be signed</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">strToSign</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//4.Signed result</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/ac/transfer</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//5.Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">strParam</span> <span class="c1">// 6.Formatting parameters</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.response data</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="c1"># BASE_URL = 'https://api.trade-planets.com'  
</span><span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">transfer</span><span class="p">(</span><span class="n">inout</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/ac/transfer'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'symbol'</span><span class="p">:</span> <span class="s">'USDT'</span><span class="p">,</span>
        <span class="s">'type'</span><span class="p">:</span> <span class="n">inout</span><span class="p">,</span>
        <span class="s">'amount'</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">transfer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># transfer in contract
</span>    <span class="n">transfer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># transfer out contract
</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/ac/transfer"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">symbol</span> <span class="p">=</span> <span class="s">"USDT"</span><span class="p">,</span>
                <span class="n">type</span> <span class="p">=</span> <span class="m">0</span><span class="p">,</span>
                <span class="n">amount</span> <span class="p">=</span> <span class="m">10</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li><p>1.Get current timestamp</p></li>
<li><p>2.Understand the parameter param required by the interface request, and format the parameter to get strParam</p></li>
<li><p>3.Generate the string strToSign that needs to be signed</p></li>
<li><p>4.Use apikey&#39;s secret to sign the string strToSign that needs to be signed with HmacMD5</p></li>
<li><p>5.When requesting, set the following fields of http headers</p></li>
</ul>

<table><thead>
<tr>
<th>Field name</th>
<th>Field type</th>
<th>Field description</th>
<th>Field value</th>
</tr>
</thead><tbody>
<tr>
<td>content-type</td>
<td>string</td>
<td></td>
<td>&#39;application/json&#39;</td>
</tr>
<tr>
<td>api-key</td>
<td>string</td>
<td>your apikey</td>
<td></td>
</tr>
<tr>
<td>api-timestamp</td>
<td>long</td>
<td>Current timestamp，expressed in milliseconds</td>
<td>timestamp</td>
</tr>
<tr>
<td>api-sign</td>
<td>string</td>
<td>Signature result</td>
<td>sign</td>
</tr>
</tbody></table>

<ul>
<li><p>6.When requesting, set http body as the formatted request parameter strParam </p></li>
<li><p>7.The return value contains the field state, 0 means success, and other error codes, means failure. Successful results will have a corresponding field result, and failed results will have a corresponding field msg.</p></li>
</ul>
<h2 id='2-fund-transfer'>2.Fund transfer</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span> <span class="c1">// 1.Current timestamp</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span> <span class="c1">// 2.Requested parameters</span>
    <span class="dl">"</span><span class="s2">amount</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">0.01</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">symbol</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">USDT</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">type</span><span class="dl">"</span><span class="p">:</span><span class="mi">0</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">strParam</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">// 2.Formatting parameters</span>

<span class="kd">let</span> <span class="nx">strToSign</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">strParam</span><span class="p">;</span> <span class="c1">// 3.This is the string that needs to be signed</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//你的 apikey 密码</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">strToSign</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//4.Signed result</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/ac/transfer</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//5.Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">strParam</span> <span class="c1">// 6.Formatting parameters</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span> <span class="c1">// 7.Response data</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="c1"># BASE_URL = 'https://api.trade-planets.com'  
</span><span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">transfer</span><span class="p">(</span><span class="n">inout</span><span class="p">,</span> <span class="n">amount</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/ac/transfer'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'symbol'</span><span class="p">:</span> <span class="s">'USDT'</span><span class="p">,</span>
        <span class="s">'type'</span><span class="p">:</span> <span class="n">inout</span><span class="p">,</span>
        <span class="s">'amount'</span><span class="p">:</span> <span class="n">amount</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">transfer</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># transfer in contract
</span>    <span class="n">transfer</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># transfer out contract
</span>
</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/ac/transfer"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">symbol</span> <span class="p">=</span> <span class="s">"USDT"</span><span class="p">,</span>
                <span class="n">type</span> <span class="p">=</span> <span class="m">0</span><span class="p">,</span>
                <span class="n">amount</span> <span class="p">=</span> <span class="m">10</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/ac/transfer</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>amount</td>
<td>true</td>
<td>string</td>
<td>Number to string</td>
<td></td>
<td></td>
</tr>
<tr>
<td>symbol</td>
<td>true</td>
<td>string</td>
<td>coin symbol</td>
<td></td>
<td>USDT</td>
</tr>
<tr>
<td>type</td>
<td>true</td>
<td>integer</td>
<td>0 transfer in, 1 transfer out</td>
<td></td>
<td>0,1</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">success</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:</span><span class="s2">"352559634189422592"</span><span class="w">  </span><span class="err">//</span><span class="w"> </span><span class="err">ignore</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='3-place-order'>3.Place order</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/tc/order/open</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">pair</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">4BTC_USDT</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">order_side</span><span class="dl">"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">order_type</span><span class="dl">"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">price</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">11500</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">amount</span><span class="dl">"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">order_from</span><span class="dl">"</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">client_oid</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1234567890</span><span class="dl">"</span><span class="p">,</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//parameter string</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="c1"># BASE_URL = 'https://api.trade-planets.com'  # 墙内 https://api.trade-planets.com
</span><span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">order_open</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/tc/order/open'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"pair"</span><span class="p">:</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
        <span class="s">"order_side"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">"order_type"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s">"price"</span><span class="p">:</span> <span class="s">"11500"</span><span class="p">,</span>
        <span class="s">"amount"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">"order_from"</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
        <span class="s">"client_oid"</span><span class="p">:</span> <span class="s">"1234567890"</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">order_open</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/tc/order/open"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">pair</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
                <span class="n">order_side</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
                <span class="n">order_type</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
                <span class="n">price</span> <span class="p">=</span> <span class="s">"11500"</span><span class="p">,</span>
                <span class="n">amount</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
                <span class="n">order_from</span> <span class="p">=</span>  <span class="m">6</span><span class="p">,</span>
                <span class="n">client_oid</span> <span class="p">=</span> <span class="s">"1234567890"</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/tc/order/open</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>true</td>
<td>string</td>
<td>Contract symbol</td>
<td></td>
<td>4BTC_USDT,4ETH_USDT, ...</td>
</tr>
<tr>
<td>amount</td>
<td>true</td>
<td>string</td>
<td>Number to string (Must be a multiple of the contract unit)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>order_side</td>
<td>true</td>
<td>integer</td>
<td>Order side, 1 open long, 2 open short, 3 close long, 4 close short</td>
<td></td>
<td>1,2,3,4</td>
</tr>
<tr>
<td>order_type</td>
<td>true</td>
<td>integer</td>
<td>Order type, 1 market order, 2 limit order</td>
<td></td>
<td>1,2</td>
</tr>
<tr>
<td>price</td>
<td>true</td>
<td>string</td>
<td>Order price</td>
<td></td>
<td></td>
</tr>
<tr>
<td>order_from</td>
<td>true</td>
<td>integer</td>
<td>Order source</td>
<td></td>
<td>6</td>
</tr>
<tr>
<td>client_oid</td>
<td>false</td>
<td>string</td>
<td>client order id</td>
<td></td>
<td></td>
</tr>
</tbody></table>

<p>If you are opening postions order and want to set a stop profit stop loss after the transaction, you can add the following parameters.</p>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>plan_type</td>
<td>true</td>
<td>integer</td>
<td>market order or limit order</td>
<td></td>
<td>1 market order，2 limit order</td>
</tr>
<tr>
<td>profit_price</td>
<td>true</td>
<td>string</td>
<td>Stop-profit trigger price (The stop-profit trigger price must be greater than the order price if the limit price is extended. When the limit is short, the stop-profit trigger price should be less than the order price. The stop-profit trigger price must be higher than the latest price when the market is open. The stop-profit trigger price should be lower than the latest price when the market is open short.)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>loss_price</td>
<td>true</td>
<td>string</td>
<td>Stop-loss trigger price (when the limit is wide, the stop-loss trigger price must be less than the order price. When limit open short, stop loss trigger price should be greater than the order price. The stop-loss trigger price must be lower than the latest price when the market is open. The stop-loss trigger price should be higher than the latest price when the market is short.)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>exec_profit_price</td>
<td>false</td>
<td>string</td>
<td>Stop-profit mandate price (must be set if plan_type=2)</td>
<td></td>
<td></td>
</tr>
<tr>
<td>exec_loss_price</td>
<td>false</td>
<td>string</td>
<td>Stop-profit mandate price (must be set if plan_type=2)</td>
<td></td>
<td></td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"order_id"</span><span class="p">:</span><span class="s2">"425510999949316"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="nl">"client_oid"</span><span class="p">:</span><span class="s2">"1234567890"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">client</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
    </span><span class="nl">"status"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">status</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">waiting</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">be</span><span class="w"> </span><span class="err">traded</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">partly</span><span class="w"> </span><span class="err">traded</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">fully</span><span class="w"> </span><span class="err">traded</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">partly</span><span class="w"> </span><span class="err">cancelled</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="err">fully</span><span class="w"> </span><span class="err">cancelled</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">failed</span><span class="w">
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"open"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">ignore</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>order_id</td>
<td>order id</td>
</tr>
<tr>
<td>client_oid</td>
<td>client order id</td>
</tr>
<tr>
<td>status</td>
<td>Order status 1 waiting to be traded, 2 partly traded, 3 fully traded, 4 partly cancelled, 5 fully cancelled, 100 order failed</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='4-cancel-order'>4.Cancel order</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/tc/order/close</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">order_id</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">425510999949316</span><span class="dl">"</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//parameter string</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">order_close</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/tc/order/close'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"425510999949316"</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">order_close</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/tc/order/close"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">order_id</span> <span class="p">=</span> <span class="s">"425510999949316"</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/tc/order/close</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>order_id</td>
<td>true</td>
<td>string</td>
<td>order id</td>
<td></td>
<td></td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">success</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:</span><span class="s2">"success"</span><span class="p">,</span><span class="w"> 
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"close"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='5-batch-cancellation'>5.Batch cancellation</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/tc/order/closeBatch</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">order_ids</span><span class="dl">"</span><span class="p">:[</span><span class="dl">"</span><span class="s2">2234567890</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">2234567891</span><span class="dl">"</span><span class="p">]</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//parameter string</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">order_close_batch</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/tc/order/closeBatch'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"order_ids"</span><span class="p">:</span> <span class="p">[</span><span class="s">"2234567890"</span><span class="p">,</span> <span class="s">"2234567891"</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">order_close_batch</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/tc/order/closeBatch"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">order_ids</span> <span class="p">=</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span><span class="s">"2234567890"</span><span class="p">,</span> <span class="s">"2234567891"</span><span class="p">},</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/tc/order/closeBatch</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>order_ids</td>
<td>true</td>
<td>Array</td>
<td>Order id array</td>
<td></td>
<td></td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">success</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:</span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"close"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='6-cancel-all-orders'>6.Cancel all orders</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/tc/order/closeAll</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">pair</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">4BTC_USDT</span><span class="dl">"</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//parameter string</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>


<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">order_close_all</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/tc/order/closeAll'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"pair"</span><span class="p">:</span> <span class="s">"4BTC_USDT"</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">order_close_all</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/tc/order/closeAll"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">pair</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/tc/order/closeAll</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>true</td>
<td>string</td>
<td>Contract symbol</td>
<td></td>
<td>4BTC_USDT,4ETH_USDT, ...</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">success</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:</span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"closeAll"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='7-place-stop-profit-stop-loss-order'>7.Place Stop-profit Stop-loss Order</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/tc/order/planOpen</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">pair</span><span class="p">:</span><span class="dl">"</span><span class="s2">4BTC_USDT</span><span class="dl">"</span><span class="p">,</span> 
    <span class="na">price</span><span class="p">:</span> <span class="mi">58000</span><span class="p">,</span> 
    <span class="na">trigger_price</span><span class="p">:</span> <span class="mi">58000</span><span class="p">,</span> 
    <span class="na">amount</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> 
    <span class="na">side</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> 
    <span class="na">plan_type</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> 
    <span class="na">book_type</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> 
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">order_plan_open</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/tc/order/planOpen'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'pair'</span><span class="p">:</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
        <span class="s">'price'</span><span class="p">:</span> <span class="mi">58000</span><span class="p">,</span>
        <span class="s">'trigger_price'</span><span class="p">:</span> <span class="mi">58000</span><span class="p">,</span>
        <span class="s">'amount'</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
        <span class="s">'side'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">'plan_type'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">'book_type'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">order_plan_open</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/tc/order/planOpen"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">pair</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
                <span class="n">price</span> <span class="p">=</span> <span class="s">"58000"</span><span class="p">,</span>
                <span class="n">trigger_price</span> <span class="p">=</span> <span class="s">"58000"</span><span class="p">,</span>
                <span class="n">amount</span> <span class="p">=</span> <span class="s">"0.001"</span><span class="p">,</span>
                <span class="n">side</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
                <span class="n">plan_type</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
                <span class="n">book_type</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/tc/order/planOpen</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>false</td>
<td>string</td>
<td>Contract symbol</td>
<td></td>
<td>4BTC_USDT,4ETH_USDT, ...</td>
</tr>
<tr>
<td>price</td>
<td>true</td>
<td>string</td>
<td>book price</td>
<td></td>
<td></td>
</tr>
<tr>
<td>trigger_price</td>
<td>true</td>
<td>string</td>
<td>trigger price</td>
<td></td>
<td></td>
</tr>
<tr>
<td>amount</td>
<td>true</td>
<td>string</td>
<td>amount</td>
<td></td>
<td></td>
</tr>
<tr>
<td>side</td>
<td>true</td>
<td>int</td>
<td>position side</td>
<td></td>
<td>1Long、2Short</td>
</tr>
<tr>
<td>plan_type</td>
<td>true</td>
<td>int</td>
<td>Stop-profit or Stop-loss</td>
<td></td>
<td>1Stop-profit、2Stop-loss</td>
</tr>
<tr>
<td>book_type</td>
<td>true</td>
<td>int</td>
<td>market order or limit order</td>
<td></td>
<td>1market order，2limit order</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="err">//</span><span class="w"> 
    </span><span class="nl">"result"</span><span class="p">:</span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"planOpen"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='8-list-stop-profit-stop-loss-order'>8.list Stop-profit Stop-loss Order</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/tc/order/planOrderList</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="na">pair</span><span class="p">:</span><span class="dl">"</span><span class="s2">4BTC_USDT</span><span class="dl">"</span><span class="p">,</span> 
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">order_plan_order_list</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/tc/order/planOrderList'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'pair'</span><span class="p">:</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">order_plan_order_list</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/tc/order/planOrderList"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">pair</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/tc/order/planOrderList</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>false</td>
<td>string</td>
<td>Contract symbol</td>
<td></td>
<td>4BTC_USDT,4ETH_USDT, ...</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"tt"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pr"</span><span class="p">:</span><span class="s2">"49900"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pt"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pid"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"q"</span><span class="p">:</span><span class="s2">"0.001"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"sd"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="nl">"r"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"bt"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"s"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1638155219319</span><span class="p">,</span><span class="w">
            </span><span class="nl">"ui"</span><span class="p">:</span><span class="mi">100006</span><span class="p">,</span><span class="w">
            </span><span class="nl">"si"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pi"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"oi"</span><span class="p">:</span><span class="s2">"5198029"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"bid"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"tp"</span><span class="p">:</span><span class="s2">"49900"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"otd"</span><span class="p">:</span><span class="s2">"0"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="err">...</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"planOrderList"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>oi</td>
<td>order id</td>
</tr>
<tr>
<td>pi</td>
<td>Contract symbol</td>
</tr>
<tr>
<td>pr</td>
<td>book price</td>
</tr>
<tr>
<td>tp</td>
<td>trigger price</td>
</tr>
<tr>
<td>q</td>
<td>book quantity</td>
</tr>
<tr>
<td>sd</td>
<td>Position side：1Long、2Short</td>
</tr>
<tr>
<td>pt</td>
<td>Stop-profit or Stop-loss：1Stop-profit、2Stop-loss</td>
</tr>
<tr>
<td>bt</td>
<td>market order or limit order：1market order，2limit order</td>
</tr>
<tr>
<td>s</td>
<td>order status：1wait trigger、2triggered、3canceled、4triggered failed、5canceled</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='9-cancel-stop-profit-stop-loss-order'>9.Cancel Stop-profit Stop-loss Order</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/tc/order/planClose</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">order_id</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">425510999949316</span><span class="dl">"</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">order_plan_close</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/tc/order/planClose'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"425510999949316"</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">order_plan_close</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/tc/order/planClose"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">order_id</span> <span class="p">=</span> <span class="s">"425510999949316"</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/tc/order/planClose</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>order_id</td>
<td>true</td>
<td>string</td>
<td>order id</td>
<td></td>
<td></td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> 
    </span><span class="nl">"result"</span><span class="p">:</span><span class="s2">"success"</span><span class="p">,</span><span class="w"> 
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"planClose"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='10-cancel-all-stop-profit-stop-loss-order'>10.Cancel all Stop-profit Stop-loss Order</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/tc/order/planCloseAll</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">pair</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">4BTC_USDT</span><span class="dl">"</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">order_plan_close_all</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/tc/order/planCloseAll'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"pair"</span><span class="p">:</span><span class="s">"4BTC_USDT"</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">order_plan_close_all</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/tc/order/planCloseAll"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">pair</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/tc/order/planCloseAll</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>false</td>
<td>string</td>
<td>Contract symbol</td>
<td></td>
<td>4BTC_USDT,4ETH_USDT, ...</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="err">//</span><span class="w"> 
    </span><span class="nl">"result"</span><span class="p">:</span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"planCloseAll"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='11-adjust-margin-on-a-fixed-position'>11.Adjust margin on a fixed position</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/tc/changeMargin</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">pair</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">4BTC_USDT</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">margin</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">0.01</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">side</span><span class="dl">"</span><span class="p">:</span><span class="mi">1</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//parameter string</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">change_margin</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/tc/changeMargin'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"pair"</span><span class="p">:</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
        <span class="s">"margin"</span><span class="p">:</span> <span class="s">"0.01"</span><span class="p">,</span>
        <span class="s">"side"</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">change_margin</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/tc/changeMargin"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">pair</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
                <span class="n">margin</span> <span class="p">=</span> <span class="s">"0.01"</span><span class="p">,</span>
                <span class="n">side</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/tc/changeMargin</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>true</td>
<td>string</td>
<td>Contract symbol</td>
<td></td>
<td>4BTC_USDT,4ETH_USDT, ...</td>
</tr>
<tr>
<td>margin</td>
<td>true</td>
<td>string</td>
<td>margin</td>
<td></td>
<td></td>
</tr>
<tr>
<td>side</td>
<td>true</td>
<td>integer</td>
<td>Position side, 1 long position, 2 short position</td>
<td></td>
<td>1，2</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">3103</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">failed</span><span class="w">
    </span><span class="nl">"msg"</span><span class="p">:</span><span class="s2">"没有持仓不支持该操作"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"changeMargin"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='12-adjust-position-mode-and-leverage'>12.Adjust position mode and leverage</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/tc/changeMode</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">pair</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">4BTC_USDT</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">mode</span><span class="dl">"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">leverage_long</span><span class="dl">"</span><span class="p">:</span><span class="mi">10</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">leverage_short</span><span class="dl">"</span><span class="p">:</span><span class="mi">20</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//parameter string</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">change_mode</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/tc/changeMode'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"pair"</span><span class="p">:</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
        <span class="s">"mode"</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s">"leverage_long"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="s">"leverage_short"</span><span class="p">:</span> <span class="mi">20</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">change_mode</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/tc/changeMode"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">pair</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
                <span class="n">mode</span> <span class="p">=</span> <span class="m">2</span><span class="p">,</span>
                <span class="n">leverage_long</span> <span class="p">=</span> <span class="m">10</span><span class="p">,</span>
                <span class="n">leverage_short</span> <span class="p">=</span> <span class="m">20</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/tc/changeMode</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>true</td>
<td>string</td>
<td>Contract symbol</td>
<td></td>
<td>4BTC_USDT,4ETH_USDT, ...</td>
</tr>
<tr>
<td>mode</td>
<td>true</td>
<td>integer</td>
<td>Position mode, 1 cross, 2 fixed</td>
<td></td>
<td>1，2</td>
</tr>
<tr>
<td>leverage_long</td>
<td>true</td>
<td>integer</td>
<td>Long leverage</td>
<td></td>
<td>1~100</td>
</tr>
<tr>
<td>leverage_short</td>
<td>true</td>
<td>integer</td>
<td>Short leverage</td>
<td></td>
<td>1~100</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:</span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"changeMode"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='13-query-assets'>13.Query assets</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/tc/assets</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1">// "coin":"USDT",</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//parameter string</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">assets</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/tc/assets'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"coin"</span><span class="p">:</span> <span class="s">"USDT"</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">assets</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/tc/assets"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">coin</span> <span class="p">=</span> <span class="s">"USDT"</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/tc/assets</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>coin</td>
<td>false</td>
<td>string</td>
<td>coin symbol</td>
<td></td>
<td>BTC，ETH，...</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:[</span><span class="w">
        </span><span class="p">{</span><span class="w"> </span><span class="err">ff:</span><span class="w"> </span><span class="err">'</span><span class="mi">0</span><span class="err">'</span><span class="p">,</span><span class="w">
           </span><span class="err">b:</span><span class="w"> </span><span class="err">'</span><span class="mf">219311.9556</span><span class="err">'</span><span class="p">,</span><span class="w">
           </span><span class="err">c:</span><span class="w"> </span><span class="err">'USDT'</span><span class="p">,</span><span class="w">
           </span><span class="err">u:</span><span class="w"> </span><span class="mi">100006</span><span class="p">,</span><span class="w">
           </span><span class="err">mc:</span><span class="w"> </span><span class="err">'</span><span class="mf">93265.8573</span><span class="err">'</span><span class="p">,</span><span class="w">
           </span><span class="err">mf:</span><span class="w"> </span><span class="err">'</span><span class="mf">60.8824</span><span class="err">'</span><span class="p">,</span><span class="w">
           </span><span class="err">fc:</span><span class="w"> </span><span class="err">'</span><span class="mi">0</span><span class="err">'</span><span class="w"> </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"assets"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>b</td>
<td>Available Balance</td>
</tr>
<tr>
<td>c</td>
<td>coin symbol</td>
</tr>
<tr>
<td>u</td>
<td>user id</td>
</tr>
<tr>
<td>ff</td>
<td>Fixed Position Frozen funds</td>
</tr>
<tr>
<td>fc</td>
<td>Cross Position Frozen funds</td>
</tr>
<tr>
<td>mf</td>
<td>Fixed Position margin</td>
</tr>
<tr>
<td>mc</td>
<td>Cross Position margin</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='14-query-position'>14.Query position</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/tc/position</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1">// "pair":"4BTC_USDT",</span>
    <span class="c1">// "side":1</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//parameter string</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">position</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/tc/position'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"pair"</span><span class="p">:</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
        <span class="s">"side"</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">position</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/tc/position"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">pair</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
                <span class="n">side</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/tc/position</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>false</td>
<td>string</td>
<td>Contract symbol</td>
<td></td>
<td>4BTC_USDT,4ETH_USDT, ...</td>
</tr>
<tr>
<td>side</td>
<td>false</td>
<td>integer</td>
<td>Position side, 1 long position, 2 short position</td>
<td></td>
<td>1，2</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"pt"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="err">//ignore</span><span class="w">
            </span><span class="nl">"f"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="err">//ignore</span><span class="w">
            </span><span class="nl">"l"</span><span class="p">:</span><span class="s2">"10"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">leverage</span><span class="w">
            </span><span class="nl">"sd"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Position</span><span class="w"> </span><span class="err">side</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">Long</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">Short</span><span class="w">
            </span><span class="nl">"pa"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Alert</span><span class="w"> </span><span class="err">price</span><span class="w">
            </span><span class="nl">"ui"</span><span class="p">:</span><span class="mi">100006</span><span class="p">,</span><span class="err">//user</span><span class="w"> </span><span class="err">id</span><span class="w">
            </span><span class="nl">"fb0"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="err">//ignore</span><span class="w">
            </span><span class="nl">"pf"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="err">//Liquidation</span><span class="w"> </span><span class="err">price</span><span class="w">
            </span><span class="nl">"md"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="err">//Position</span><span class="w"> </span><span class="err">mode</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">Cross</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">Fixed</span><span class="w">
            </span><span class="nl">"lc"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Can</span><span class="w"> </span><span class="err">liquidate</span><span class="w"> </span><span class="err">position</span><span class="w"> </span><span class="err">value</span><span class="w">
            </span><span class="nl">"pi"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">pair</span><span class="w">
            </span><span class="nl">"mg"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//margin</span><span class="w">
            </span><span class="nl">"hc"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Position</span><span class="w"> </span><span class="err">value</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">Contract</span><span class="w"> </span><span class="err">number</span><span class="w"> </span><span class="err">multiplied</span><span class="w"> </span><span class="err">by</span><span class="w"> </span><span class="err">contract</span><span class="w"> </span><span class="err">value</span><span class="w">
            </span><span class="nl">"fb"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="err">//ignore</span><span class="w">
            </span><span class="nl">"po"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Open</span><span class="w"> </span><span class="err">price</span><span class="w">
            </span><span class="nl">"pp"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"ps"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="err">...</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"position"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>l</td>
<td>leverage</td>
</tr>
<tr>
<td>sd</td>
<td>Position side, 1 Long, 2 Short</td>
</tr>
<tr>
<td>pa</td>
<td>Alert price</td>
</tr>
<tr>
<td>ui</td>
<td>user id</td>
</tr>
<tr>
<td>pf</td>
<td>Liquidation price</td>
</tr>
<tr>
<td>md</td>
<td>Position mode, 1 Cross, 2 Fixed</td>
</tr>
<tr>
<td>lc</td>
<td>Can liquidate position value</td>
</tr>
<tr>
<td>pi</td>
<td>pair</td>
</tr>
<tr>
<td>mg</td>
<td>margin</td>
</tr>
<tr>
<td>hc</td>
<td>Position value = Contract number multiplied by contract value</td>
</tr>
<tr>
<td>po</td>
<td>Open price</td>
</tr>
<tr>
<td>pp</td>
<td>Stop-profit quantity</td>
</tr>
<tr>
<td>ps</td>
<td>Stop-loss quantity</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='15-query-order-list'>15.Query order list</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/tc/order/list</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1">// "pair":"4BTC_USDT",</span>
    <span class="c1">// "order_side":1</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//parameter string</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">order_list</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/tc/order/list'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"pair"</span><span class="p">:</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
        <span class="s">"order_side"</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">order_list</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/tc/order/list"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">pair</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
                <span class="n">order_side</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/tc/order/list</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>false</td>
<td>string</td>
<td>Contract symbol</td>
<td></td>
<td>4BTC_USDT,4ETH_USDT, ...</td>
</tr>
<tr>
<td>order_side</td>
<td>true</td>
<td>integer</td>
<td>Order side, 1 open long, 2 open short, 3 close long, 4 close short</td>
<td></td>
<td>1,2,3,4</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"p"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"o"</span><span class="p">:[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"f"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//fee</span><span class="w">
                </span><span class="nl">"dp"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Deal</span><span class="w"> </span><span class="err">price</span><span class="w">
                </span><span class="nl">"eq"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Deal</span><span class="w"> </span><span class="err">amount</span><span class="w">
                </span><span class="nl">"p"</span><span class="p">:</span><span class="s2">"11092"</span><span class="p">,</span><span class="w"> </span><span class="err">//Order</span><span class="w"> </span><span class="err">price</span><span class="w">
                </span><span class="nl">"tif"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">ignore</span><span class="w">
                </span><span class="nl">"q"</span><span class="p">:</span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="err">//Order</span><span class="w"> </span><span class="err">quantity</span><span class="w">
                </span><span class="nl">"sd"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//Order</span><span class="w"> </span><span class="err">side</span><span class="w">
                </span><span class="nl">"r"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//reason</span><span class="w">
                </span><span class="nl">"s"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">status</span><span class="w">
                </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1602679944815</span><span class="p">,</span><span class="w"> </span><span class="err">//time</span><span class="w">
                </span><span class="nl">"ui"</span><span class="p">:</span><span class="mi">100006</span><span class="p">,</span><span class="w"> </span><span class="err">//user</span><span class="w"> </span><span class="err">id</span><span class="w">
                </span><span class="nl">"fz"</span><span class="p">:</span><span class="s2">"0.0000091417"</span><span class="p">,</span><span class="w"> </span><span class="err">//Frozen</span><span class="w"> </span><span class="err">funds</span><span class="w">
                </span><span class="nl">"fb0"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Coupon</span><span class="w"> </span><span class="err">deduction</span><span class="w">
                </span><span class="nl">"of"</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="err">//order</span><span class="w"> </span><span class="err">from</span><span class="w">
                </span><span class="nl">"pi"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//pair</span><span class="w">
                </span><span class="nl">"oi"</span><span class="p">:</span><span class="s2">"426610511577093"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
                </span><span class="nl">"coi"</span><span class="p">:</span><span class="s2">"1602679943911"</span><span class="p">,</span><span class="w"> </span><span class="err">//clientoid</span><span class="w">
                </span><span class="nl">"fb"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Token</span><span class="w"> </span><span class="err">deduction</span><span class="w">
                </span><span class="nl">"po"</span><span class="p">:</span><span class="kc">false</span><span class="w"> </span><span class="err">//ignore</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="err">...</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"orderList"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>f</td>
<td>fee</td>
</tr>
<tr>
<td>dp</td>
<td>Deal price</td>
</tr>
<tr>
<td>eq</td>
<td>Deal amount</td>
</tr>
<tr>
<td>p</td>
<td>Order price</td>
</tr>
<tr>
<td>q</td>
<td>Order quantity</td>
</tr>
<tr>
<td>sd</td>
<td>Order side</td>
</tr>
<tr>
<td>r</td>
<td>Reason for failure</td>
</tr>
<tr>
<td>s</td>
<td>Order status</td>
</tr>
<tr>
<td>t</td>
<td>time</td>
</tr>
<tr>
<td>ui</td>
<td>user id</td>
</tr>
<tr>
<td>fz</td>
<td>Frozen funds</td>
</tr>
<tr>
<td>fb0</td>
<td>Coupon deduction</td>
</tr>
<tr>
<td>of</td>
<td>Order source</td>
</tr>
<tr>
<td>pi</td>
<td>pair</td>
</tr>
<tr>
<td>oi</td>
<td>order id</td>
</tr>
<tr>
<td>coi</td>
<td>Client order id</td>
</tr>
<tr>
<td>fb</td>
<td>Token deduction</td>
</tr>
<tr>
<td>bt</td>
<td>Stop-profit and stop-loss orders: 1 market price, 2 limit price, Otherwise no stop-profit and stop-loss is set.</td>
</tr>
<tr>
<td>tw</td>
<td>Stop earnings trigger price</td>
</tr>
<tr>
<td>tl</td>
<td>Stop loss trigger price</td>
</tr>
<tr>
<td>pw</td>
<td>Stop-profit order price (ignored if bt =1)</td>
</tr>
<tr>
<td>pl</td>
<td>Stop loss order price (ignored if bt =1)</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='16-query-order'>16.Query order</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/tc/order/detail</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">order_id</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">426610511577093</span><span class="dl">"</span><span class="p">,</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//parameter string</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">order_detail</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/tc/order/detail'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"order_id"</span><span class="p">:</span> <span class="s">"426610511577093"</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">order_detail</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/tc/order/detail"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">order_id</span> <span class="p">=</span> <span class="s">"426610511577093"</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/tc/order/detail</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>order_id</td>
<td>true</td>
<td>string</td>
<td>order id</td>
<td></td>
<td></td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"f"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//fee</span><span class="w">
        </span><span class="nl">"dp"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Deal</span><span class="w"> </span><span class="err">price</span><span class="w">
        </span><span class="nl">"eq"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Deal</span><span class="w"> </span><span class="err">amount</span><span class="w">
        </span><span class="nl">"p"</span><span class="p">:</span><span class="s2">"11092"</span><span class="p">,</span><span class="w"> </span><span class="err">//Order</span><span class="w"> </span><span class="err">price</span><span class="w">
        </span><span class="nl">"tif"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">ignore</span><span class="w">
        </span><span class="nl">"q"</span><span class="p">:</span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="err">//Order</span><span class="w"> </span><span class="err">quantity</span><span class="w">
        </span><span class="nl">"sd"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//Order</span><span class="w"> </span><span class="err">side</span><span class="w">
        </span><span class="nl">"r"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//reason</span><span class="w">
        </span><span class="nl">"s"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">status</span><span class="w">
        </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1602679944815</span><span class="p">,</span><span class="w"> </span><span class="err">//time</span><span class="w">
        </span><span class="nl">"ui"</span><span class="p">:</span><span class="mi">100006</span><span class="p">,</span><span class="w"> </span><span class="err">//user</span><span class="w"> </span><span class="err">id</span><span class="w">
        </span><span class="nl">"fz"</span><span class="p">:</span><span class="s2">"0.0000091417"</span><span class="p">,</span><span class="w"> </span><span class="err">//Frozen</span><span class="w"> </span><span class="err">funds</span><span class="w">
        </span><span class="nl">"fb0"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Coupon</span><span class="w"> </span><span class="err">deduction</span><span class="w">
        </span><span class="nl">"of"</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="err">//order</span><span class="w"> </span><span class="err">from</span><span class="w">
        </span><span class="nl">"pi"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//pair</span><span class="w">
        </span><span class="nl">"oi"</span><span class="p">:</span><span class="s2">"426610511577093"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
        </span><span class="nl">"coi"</span><span class="p">:</span><span class="s2">"1602679943911"</span><span class="p">,</span><span class="w"> </span><span class="err">//clientoid</span><span class="w">
        </span><span class="nl">"fb"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Token</span><span class="w"> </span><span class="err">deduction</span><span class="w">
        </span><span class="nl">"po"</span><span class="p">:</span><span class="kc">false</span><span class="w"> </span><span class="err">//ignore</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"orderDetail"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>f</td>
<td>fee</td>
</tr>
<tr>
<td>dp</td>
<td>Deal price</td>
</tr>
<tr>
<td>eq</td>
<td>Deal amount</td>
</tr>
<tr>
<td>p</td>
<td>Order price</td>
</tr>
<tr>
<td>q</td>
<td>Order quantity</td>
</tr>
<tr>
<td>sd</td>
<td>Order side</td>
</tr>
<tr>
<td>r</td>
<td>Reason for failure</td>
</tr>
<tr>
<td>s</td>
<td>Order status</td>
</tr>
<tr>
<td>t</td>
<td>time</td>
</tr>
<tr>
<td>ui</td>
<td>user id</td>
</tr>
<tr>
<td>fz</td>
<td>Frozen funds</td>
</tr>
<tr>
<td>fb0</td>
<td>Coupon deduction</td>
</tr>
<tr>
<td>of</td>
<td>Order source</td>
</tr>
<tr>
<td>pi</td>
<td>pair</td>
</tr>
<tr>
<td>oi</td>
<td>order id</td>
</tr>
<tr>
<td>coi</td>
<td>Client order id</td>
</tr>
<tr>
<td>fb</td>
<td>Token deduction</td>
</tr>
<tr>
<td>bt</td>
<td>Stop-profit and stop-loss orders: 1 market price, 2 limit price, Otherwise no stop-profit and stop-loss is set.</td>
</tr>
<tr>
<td>tw</td>
<td>Stop earnings trigger price</td>
</tr>
<tr>
<td>tl</td>
<td>Stop loss trigger price</td>
</tr>
<tr>
<td>pw</td>
<td>Stop-profit order price (ignored if bt =1)</td>
</tr>
<tr>
<td>pl</td>
<td>Stop loss order price (ignored if bt =1)</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='17-batch-query-order'>17. Batch query order</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/tc/order/listBatch</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">order_ids</span><span class="dl">"</span><span class="p">:[</span><span class="dl">"</span><span class="s2">426610511577093</span><span class="dl">"</span><span class="p">],</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//parameter string</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">order_list_batch</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/tc/order/listBatch'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"order_ids"</span><span class="p">:</span> <span class="p">[</span><span class="s">"426610511577093"</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">order_list_batch</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/tc/order/listBatch"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">order_ids</span> <span class="p">=</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span><span class="s">"426610511577093"</span><span class="p">},</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/tc/order/listBatch</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>order_ids</td>
<td>true</td>
<td>Array</td>
<td>Order id array</td>
<td></td>
<td></td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:[</span><span class="w">
        </span><span class="p">{</span><span class="w">
             </span><span class="nl">"f"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//fee</span><span class="w">
            </span><span class="nl">"dp"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Deal</span><span class="w"> </span><span class="err">price</span><span class="w">
            </span><span class="nl">"eq"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Deal</span><span class="w"> </span><span class="err">amount</span><span class="w">
            </span><span class="nl">"p"</span><span class="p">:</span><span class="s2">"11092"</span><span class="p">,</span><span class="w"> </span><span class="err">//Order</span><span class="w"> </span><span class="err">price</span><span class="w">
            </span><span class="nl">"tif"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">ignore</span><span class="w">
            </span><span class="nl">"q"</span><span class="p">:</span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="err">//Order</span><span class="w"> </span><span class="err">quantity</span><span class="w">
            </span><span class="nl">"sd"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//Order</span><span class="w"> </span><span class="err">side</span><span class="w">
            </span><span class="nl">"r"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//reason</span><span class="w">
            </span><span class="nl">"s"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">status</span><span class="w">
            </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1602679944815</span><span class="p">,</span><span class="w"> </span><span class="err">//time</span><span class="w">
            </span><span class="nl">"ui"</span><span class="p">:</span><span class="mi">100006</span><span class="p">,</span><span class="w"> </span><span class="err">//user</span><span class="w"> </span><span class="err">id</span><span class="w">
            </span><span class="nl">"fz"</span><span class="p">:</span><span class="s2">"0.0000091417"</span><span class="p">,</span><span class="w"> </span><span class="err">//Frozen</span><span class="w"> </span><span class="err">funds</span><span class="w">
            </span><span class="nl">"fb0"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Coupon</span><span class="w"> </span><span class="err">deduction</span><span class="w">
            </span><span class="nl">"of"</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="err">//order</span><span class="w"> </span><span class="err">from</span><span class="w">
            </span><span class="nl">"pi"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//pair</span><span class="w">
            </span><span class="nl">"oi"</span><span class="p">:</span><span class="s2">"426610511577093"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
            </span><span class="nl">"coi"</span><span class="p">:</span><span class="s2">"1602679943911"</span><span class="p">,</span><span class="w"> </span><span class="err">//clientoid</span><span class="w">
            </span><span class="nl">"fb"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Token</span><span class="w"> </span><span class="err">deduction</span><span class="w">
            </span><span class="nl">"po"</span><span class="p">:</span><span class="kc">false</span><span class="w"> </span><span class="err">//ignore</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"orderListBatch"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>f</td>
<td>fee</td>
</tr>
<tr>
<td>dp</td>
<td>Deal price</td>
</tr>
<tr>
<td>eq</td>
<td>Deal amount</td>
</tr>
<tr>
<td>p</td>
<td>Order price</td>
</tr>
<tr>
<td>q</td>
<td>Order quantity</td>
</tr>
<tr>
<td>sd</td>
<td>Order side</td>
</tr>
<tr>
<td>r</td>
<td>Reason for failure</td>
</tr>
<tr>
<td>s</td>
<td>Order status</td>
</tr>
<tr>
<td>t</td>
<td>time</td>
</tr>
<tr>
<td>ui</td>
<td>user id</td>
</tr>
<tr>
<td>fz</td>
<td>Frozen funds</td>
</tr>
<tr>
<td>fb0</td>
<td>Coupon deduction</td>
</tr>
<tr>
<td>of</td>
<td>Order source</td>
</tr>
<tr>
<td>pi</td>
<td>pair</td>
</tr>
<tr>
<td>oi</td>
<td>order id</td>
</tr>
<tr>
<td>coi</td>
<td>Client order id</td>
</tr>
<tr>
<td>fb</td>
<td>Token deduction</td>
</tr>
<tr>
<td>bt</td>
<td>Stop-profit and stop-loss orders: 1 market price, 2 limit price, Otherwise no stop-profit and stop-loss is set.</td>
</tr>
<tr>
<td>tw</td>
<td>Stop earnings trigger price</td>
</tr>
<tr>
<td>tl</td>
<td>Stop loss trigger price</td>
</tr>
<tr>
<td>pw</td>
<td>Stop-profit order price (ignored if bt =1)</td>
</tr>
<tr>
<td>pl</td>
<td>Stop loss order price (ignored if bt =1)</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='18-query-order-list-based-on-clientoid'>18.Query order list based on clientoid</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/tc/order/listBatchByClientOid</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">order_ids</span><span class="dl">"</span><span class="p">:[</span><span class="dl">"</span><span class="s2">1602679943911</span><span class="dl">"</span><span class="p">],</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//parameter string</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">order_list_batch_by_client_oid</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/tc/order/listBatchByClientOid'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"order_ids"</span><span class="p">:</span> <span class="p">[</span><span class="s">"1602679943911"</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">order_list_batch_by_client_oid</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
       <span class="p">{</span>
           <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
           <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
           <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

           <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
           <span class="p">{</span>
               <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
           <span class="p">}</span>

           <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

           <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
       <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/tc/order/listBatchByClientOid"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                <span class="n">order_ids</span> <span class="p">=</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span><span class="s">"1602679943911"</span><span class="p">},</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/tc/order/listBatchByClientOid</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>order_ids</td>
<td>true</td>
<td>Array</td>
<td>Array of client order id</td>
<td></td>
<td></td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:[</span><span class="w">
        </span><span class="p">{</span><span class="w">
             </span><span class="nl">"f"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//fee</span><span class="w">
            </span><span class="nl">"dp"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Deal</span><span class="w"> </span><span class="err">price</span><span class="w">
            </span><span class="nl">"eq"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Deal</span><span class="w"> </span><span class="err">amount</span><span class="w">
            </span><span class="nl">"p"</span><span class="p">:</span><span class="s2">"11092"</span><span class="p">,</span><span class="w"> </span><span class="err">//Order</span><span class="w"> </span><span class="err">price</span><span class="w">
            </span><span class="nl">"tif"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">ignore</span><span class="w">
            </span><span class="nl">"q"</span><span class="p">:</span><span class="s2">"1"</span><span class="p">,</span><span class="w"> </span><span class="err">//Order</span><span class="w"> </span><span class="err">quantity</span><span class="w">
            </span><span class="nl">"sd"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//Order</span><span class="w"> </span><span class="err">side</span><span class="w">
            </span><span class="nl">"r"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="err">//reason</span><span class="w">
            </span><span class="nl">"s"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">status</span><span class="w">
            </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1602679944815</span><span class="p">,</span><span class="w"> </span><span class="err">//time</span><span class="w">
            </span><span class="nl">"ui"</span><span class="p">:</span><span class="mi">100006</span><span class="p">,</span><span class="w"> </span><span class="err">//user</span><span class="w"> </span><span class="err">id</span><span class="w">
            </span><span class="nl">"fz"</span><span class="p">:</span><span class="s2">"0.0000091417"</span><span class="p">,</span><span class="w"> </span><span class="err">//Frozen</span><span class="w"> </span><span class="err">funds</span><span class="w">
            </span><span class="nl">"fb0"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Coupon</span><span class="w"> </span><span class="err">deduction</span><span class="w">
            </span><span class="nl">"of"</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="err">//order</span><span class="w"> </span><span class="err">from</span><span class="w">
            </span><span class="nl">"pi"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w"> </span><span class="err">//pair</span><span class="w">
            </span><span class="nl">"oi"</span><span class="p">:</span><span class="s2">"426610511577093"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
            </span><span class="nl">"coi"</span><span class="p">:</span><span class="s2">"1602679943911"</span><span class="p">,</span><span class="w"> </span><span class="err">//clientoid</span><span class="w">
            </span><span class="nl">"fb"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w"> </span><span class="err">//Token</span><span class="w"> </span><span class="err">deduction</span><span class="w">
            </span><span class="nl">"po"</span><span class="p">:</span><span class="kc">false</span><span class="w"> </span><span class="err">//ignore</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"orderListBatchByCLientOid"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>f</td>
<td>fee</td>
</tr>
<tr>
<td>dp</td>
<td>Deal price</td>
</tr>
<tr>
<td>eq</td>
<td>Deal amount</td>
</tr>
<tr>
<td>p</td>
<td>Order price</td>
</tr>
<tr>
<td>q</td>
<td>Order quantity</td>
</tr>
<tr>
<td>sd</td>
<td>Order side</td>
</tr>
<tr>
<td>r</td>
<td>Reason for failure</td>
</tr>
<tr>
<td>s</td>
<td>Order status</td>
</tr>
<tr>
<td>t</td>
<td>time</td>
</tr>
<tr>
<td>ui</td>
<td>user id</td>
</tr>
<tr>
<td>fz</td>
<td>Frozen funds</td>
</tr>
<tr>
<td>fb0</td>
<td>Coupon deduction</td>
</tr>
<tr>
<td>of</td>
<td>Order source</td>
</tr>
<tr>
<td>pi</td>
<td>pair</td>
</tr>
<tr>
<td>oi</td>
<td>order id</td>
</tr>
<tr>
<td>coi</td>
<td>Client order id</td>
</tr>
<tr>
<td>fb</td>
<td>Token deduction</td>
</tr>
<tr>
<td>bt</td>
<td>Stop-profit and stop-loss orders: 1 market price, 2 limit price, Otherwise no stop-profit and stop-loss is set.</td>
</tr>
<tr>
<td>tw</td>
<td>Stop earnings trigger price</td>
</tr>
<tr>
<td>tl</td>
<td>Stop loss trigger price</td>
</tr>
<tr>
<td>pw</td>
<td>Stop-profit order price (ignored if bt =1)</td>
</tr>
<tr>
<td>pl</td>
<td>Stop loss order price (ignored if bt =1)</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='19-get-server-time'>19.Get server time</h2>
<ul>
<li>1.Request path</li>
</ul>

<p>GET https://api.trade-planets.com/api/v1/tc/timestamp</p>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"time"</span><span class="p">:</span><span class="s2">"1602680518605"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>2.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>time</td>
<td>server time</td>
</tr>
</tbody></table>
<h2 id='20-qeury-position-holding-changed-records'>20.Qeury position holding changed records</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/qc/deal/log</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">pair</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">4BTC_USDT</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">page</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">size</span><span class="dl">"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//parameter string</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="p">,</span> <span class="n">getopt</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">get_baseu_deal_log</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/qc/deal/log'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"pair"</span><span class="p">:</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
        <span class="s">"page"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">"size"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">get_baseu_deal_log</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
               <span class="p">{</span>
                   <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
                   <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
                   <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

                   <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
                   <span class="p">{</span>
                       <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
                   <span class="p">}</span>

                   <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

                   <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
               <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/qc/deal/log"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                 <span class="n">pair</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
                 <span class="n">page</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
                 <span class="n">size</span> <span class="p">=</span> <span class="m">10</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/qc/deal/log</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>true</td>
<td>string</td>
<td>Contract symbol</td>
<td></td>
<td>4BTC_USDT,4ETH_USDT, ...</td>
</tr>
<tr>
<td>page</td>
<td>true</td>
<td>integer</td>
<td>page number</td>
<td></td>
<td>1,2, ...</td>
</tr>
<tr>
<td>size</td>
<td>true</td>
<td>integer</td>
<td>return size</td>
<td></td>
<td>10,20, ...</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"count"</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="w">
        </span><span class="nl">"page"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"items"</span><span class="p">:[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"1125899906842635654"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">record</span><span class="w"> </span><span class="err">id</span><span class="w">
                </span><span class="nl">"user_id"</span><span class="p">:</span><span class="mi">100006</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">user</span><span class="w"> </span><span class="err">id</span><span class="w">
                </span><span class="nl">"coin_symbol"</span><span class="p">:</span><span class="s2">"USDT"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">coin</span><span class="w"> </span><span class="err">symbol</span><span class="w">
                </span><span class="nl">"pair"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">pair</span><span class="w">
                </span><span class="nl">"side"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Position</span><span class="w"> </span><span class="err">side</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">Long</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">Short</span><span class="w">
                </span><span class="nl">"model"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Position</span><span class="w"> </span><span class="err">model</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="err">Cross</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="err">Fixed</span><span class="w">
                </span><span class="nl">"log_type"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Record</span><span class="w"> </span><span class="err">type</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">position</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">close</span><span class="w"> </span><span class="err">position</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">lighten</span><span class="w"> </span><span class="err">position</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">reduce</span><span class="w"> </span><span class="err">risk</span><span class="w"> </span><span class="err">level</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">liquidate</span><span class="w"> </span><span class="err">position</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="err">ADL</span><span class="w">
                </span><span class="nl">"hold_coin_dx"</span><span class="p">:</span><span class="s2">"1.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Change</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="err">position</span><span class="w">
                </span><span class="nl">"hold_coin"</span><span class="p">:</span><span class="s2">"1.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Position</span><span class="w"> </span><span class="err">holding</span><span class="w">
                </span><span class="nl">"price_log"</span><span class="p">:</span><span class="s2">"11692.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">proposed</span><span class="w"> </span><span class="err">price</span><span class="w">
                </span><span class="nl">"price_open"</span><span class="p">:</span><span class="s2">"11692.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Average</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">price</span><span class="w">
                </span><span class="nl">"profit"</span><span class="p">:</span><span class="s2">"0.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">profit</span><span class="w">
                </span><span class="nl">"fee"</span><span class="p">:</span><span class="s2">"0.0000000599"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">fee</span><span class="w">
                </span><span class="nl">"fee_bix"</span><span class="p">:</span><span class="s2">"0.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Token</span><span class="w"> </span><span class="err">deduction</span><span class="w">
                </span><span class="nl">"fee_bix0"</span><span class="p">:</span><span class="s2">"0.0000000000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Coupon</span><span class="w"> </span><span class="err">deduction</span><span class="w">
                </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="s2">"2020-10-14T03:00:08.000Z"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">time</span><span class="w">
                </span><span class="nl">"updatedAt"</span><span class="p">:</span><span class="s2">"2020-10-14T03:00:08.000Z"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="err">...</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>id</td>
<td>record id</td>
</tr>
<tr>
<td>user_id</td>
<td>user id</td>
</tr>
<tr>
<td>coin_symbol</td>
<td>coin symbol</td>
</tr>
<tr>
<td>pair</td>
<td>pair</td>
</tr>
<tr>
<td>side</td>
<td>Position side, 1 Long, 2 Short</td>
</tr>
<tr>
<td>model</td>
<td>Position model, 1Cross, 2Fixed</td>
</tr>
<tr>
<td>log_type</td>
<td>Record type, 1 open position, 2 close position, 3 lighten position to reduce risk level, 4 liquidate position, 5ADL</td>
</tr>
<tr>
<td>hold_coin_dx</td>
<td>Change in position</td>
</tr>
<tr>
<td>hold_coin</td>
<td>Position holding</td>
</tr>
<tr>
<td>price_log</td>
<td>proposed price</td>
</tr>
<tr>
<td>price_open</td>
<td>Average open price</td>
</tr>
<tr>
<td>profit</td>
<td>profit</td>
</tr>
<tr>
<td>fee</td>
<td>fee</td>
</tr>
<tr>
<td>fee_bix</td>
<td>Token deduction</td>
</tr>
<tr>
<td>fee_bix0</td>
<td>Coupon deduction</td>
</tr>
<tr>
<td>createdAt</td>
<td>time</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='21-query-order-deals-detail'>21.Query order deals detail</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/qc/order/detail</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">orderId</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">421112953438213</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">page</span><span class="dl">"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">size</span><span class="dl">"</span><span class="p">:</span><span class="mi">10</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//parameter string</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="p">,</span> <span class="n">getopt</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">get_baseu_order_detail</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/qc/order/detail'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"orderId"</span><span class="p">:</span> <span class="s">"421112953438213"</span><span class="p">,</span>
        <span class="s">"page"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">"size"</span><span class="p">:</span> <span class="mi">10</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">get_baseu_order_detail</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
               <span class="p">{</span>
                   <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
                   <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
                   <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

                   <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
                   <span class="p">{</span>
                       <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
                   <span class="p">}</span>

                   <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

                   <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
               <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/qc/order/detail"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                 <span class="n">orderId</span> <span class="p">=</span> <span class="s">"421112953438213"</span><span class="p">,</span>
                 <span class="n">page</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
                 <span class="n">size</span> <span class="p">=</span> <span class="m">10</span><span class="p">,</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/qc/order/detail</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>orderId</td>
<td>true</td>
<td>long</td>
<td>order id</td>
<td></td>
<td></td>
</tr>
<tr>
<td>page</td>
<td>true</td>
<td>integer</td>
<td>page number</td>
<td></td>
<td>1,2, ...</td>
</tr>
<tr>
<td>size</td>
<td>true</td>
<td>integer</td>
<td>return size</td>
<td></td>
<td>10,20, ...</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"count"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"page"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"items"</span><span class="p">:[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"1125899906842635651"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">record</span><span class="w"> </span><span class="err">id</span><span class="w">
                </span><span class="nl">"coin_symbol"</span><span class="p">:</span><span class="s2">"USDT"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">coin</span><span class="w"> </span><span class="err">symbol</span><span class="w">
                </span><span class="nl">"pair"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">pair</span><span class="w">
                </span><span class="nl">"side"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Pending</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">side</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">long</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">short</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">close</span><span class="w"> </span><span class="err">long</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">close</span><span class="w"> </span><span class="err">short</span><span class="w">
                </span><span class="nl">"order_from"</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">source</span><span class="w">
                </span><span class="nl">"price"</span><span class="p">:</span><span class="s2">"10692.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Pending</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">price</span><span class="w">
                </span><span class="nl">"deal_price"</span><span class="p">:</span><span class="s2">"11510.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Deal</span><span class="w"> </span><span class="err">price</span><span class="w">
                </span><span class="nl">"deal_coin"</span><span class="p">:</span><span class="s2">"1.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Deal</span><span class="w"> </span><span class="err">amount</span><span class="w">
                </span><span class="nl">"fee"</span><span class="p">:</span><span class="s2">"0.0000000608"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">fee</span><span class="w">
                </span><span class="nl">"fee_bix"</span><span class="p">:</span><span class="s2">"0.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Token</span><span class="w"> </span><span class="err">deduction</span><span class="w">
                </span><span class="nl">"fee_bix0"</span><span class="p">:</span><span class="s2">"0.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Coupon</span><span class="w"> </span><span class="err">deduction</span><span class="w">
                </span><span class="nl">"is_maker"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">is</span><span class="w"> </span><span class="err">maker</span><span class="w">
                </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="s2">"2020-10-14T02:58:59.000Z"</span><span class="err">//</span><span class="w"> </span><span class="err">time</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>id</td>
<td>record id</td>
</tr>
<tr>
<td>coin_symbol</td>
<td>coin symbol</td>
</tr>
<tr>
<td>pair</td>
<td>pair</td>
</tr>
<tr>
<td>side</td>
<td>Pending order side, 1 open long, 2 open short, 3 close long, 4 close short</td>
</tr>
<tr>
<td>order_from</td>
<td>Order source</td>
</tr>
<tr>
<td>price</td>
<td>Pending order price</td>
</tr>
<tr>
<td>deal_price</td>
<td>Deal price</td>
</tr>
<tr>
<td>deal_coin</td>
<td>Deal amount</td>
</tr>
<tr>
<td>fee</td>
<td>fee</td>
</tr>
<tr>
<td>fee_bix</td>
<td>Token deduction</td>
</tr>
<tr>
<td>fee_bix0</td>
<td>Coupon deduction</td>
</tr>
<tr>
<td>createdAt</td>
<td>time</td>
</tr>
<tr>
<td>is_maker</td>
<td>is maker</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='22-query-historical-orders'>22.Query historical orders</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/qc/order/history</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">page</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">size</span><span class="dl">"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">pair</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">4BTC_USDT</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">side</span><span class="dl">"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">status</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//parameter string</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="p">,</span> <span class="n">getopt</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">get_baseu_order_history</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/qc/order/history'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"page"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">"size"</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
        <span class="s">"pair"</span><span class="p">:</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
        <span class="s">"side"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s">"status"</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">get_baseu_order_history</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
               <span class="p">{</span>
                   <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
                   <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
                   <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

                   <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
                   <span class="p">{</span>
                       <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
                   <span class="p">}</span>

                   <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

                   <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
               <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/qc/order/history"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                 <span class="n">page</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
                 <span class="n">size</span> <span class="p">=</span> <span class="m">10</span><span class="p">,</span>
                 <span class="n">pair</span> <span class="p">=</span> <span class="s">"4BTC_USDT"</span><span class="p">,</span>
                 <span class="n">side</span> <span class="p">=</span> <span class="m">1</span><span class="p">,</span>
                 <span class="n">status</span> <span class="p">=</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span><span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">100</span><span class="p">},</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/qc/order/history</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>false</td>
<td>string</td>
<td>Contract symbol</td>
<td></td>
<td>4BTC_USDT,4ETH_USDT, ...</td>
</tr>
<tr>
<td>page</td>
<td>true</td>
<td>integer</td>
<td>page number</td>
<td></td>
<td>1,2, ...</td>
</tr>
<tr>
<td>size</td>
<td>true</td>
<td>integer</td>
<td>return size</td>
<td></td>
<td>10,20, ...</td>
</tr>
<tr>
<td>side</td>
<td>false</td>
<td>integer</td>
<td>Order side, 1 open long 2 open short 3 close long 4 close short</td>
<td></td>
<td></td>
</tr>
<tr>
<td>status</td>
<td>false</td>
<td>Array</td>
<td>Order status, 1 uncompleted, 2 partially completed, 3 completely completed, 4 partially cancelled, 5 completely cancelled, 100 failed to place an order</td>
<td></td>
<td></td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"count"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"page"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="nl">"items"</span><span class="p">:[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">421112953438215</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
                </span><span class="nl">"user_id"</span><span class="p">:</span><span class="mi">100006</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">user</span><span class="w"> </span><span class="err">id</span><span class="w">
                </span><span class="nl">"coin_symbol"</span><span class="p">:</span><span class="s2">"USDT"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">coin</span><span class="w"> </span><span class="err">symbol</span><span class="w">
                </span><span class="nl">"pair"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">pair</span><span class="w">
                </span><span class="nl">"side"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">side</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">long</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">short</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">close</span><span class="w"> </span><span class="err">long</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">close</span><span class="w"> </span><span class="err">short</span><span class="w">
                </span><span class="nl">"order_type"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">type</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">market</span><span class="w"> </span><span class="err">price</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">limit</span><span class="w"> </span><span class="err">price</span><span class="w">
                </span><span class="nl">"price"</span><span class="p">:</span><span class="s2">"11692.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Pending</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">price</span><span class="w">
                </span><span class="nl">"amount_coin"</span><span class="p">:</span><span class="s2">"1.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">quantity</span><span class="w">
                </span><span class="nl">"freeze"</span><span class="p">:</span><span class="s2">"0.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Frozen</span><span class="w"> </span><span class="err">funds</span><span class="w">
                </span><span class="nl">"price_deal"</span><span class="p">:</span><span class="s2">"11692.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Average</span><span class="w"> </span><span class="err">deal</span><span class="w"> </span><span class="err">price</span><span class="w">
                </span><span class="nl">"deal_coin"</span><span class="p">:</span><span class="s2">"1.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Deal</span><span class="w"> </span><span class="err">amount</span><span class="w">
                </span><span class="nl">"deal_num"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Deal</span><span class="w"> </span><span class="err">number</span><span class="w">
                </span><span class="nl">"fee"</span><span class="p">:</span><span class="s2">"0.0000000599"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">fee</span><span class="w">
                </span><span class="nl">"fee_bix"</span><span class="p">:</span><span class="s2">"0.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Token</span><span class="w"> </span><span class="err">deduction</span><span class="w">
                </span><span class="nl">"fee_bix0"</span><span class="p">:</span><span class="s2">"0.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Coupon</span><span class="w"> </span><span class="err">deduction</span><span class="w">
                </span><span class="nl">"status"</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">status</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">uncompleted</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">partially</span><span class="w"> </span><span class="err">completed</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">completely</span><span class="w"> </span><span class="err">completed</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">partially</span><span class="w"> </span><span class="err">cancelled</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="err">completely</span><span class="w"> </span><span class="err">cancelled</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="err">failed</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">place</span><span class="w"> </span><span class="err">an</span><span class="w"> </span><span class="err">order</span><span class="w">
                </span><span class="nl">"reason"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Reason</span><span class="w"> </span><span class="err">for</span><span class="w"> </span><span class="err">failure</span><span class="w">
                </span><span class="nl">"fee_rate_maker"</span><span class="p">:</span><span class="s2">"0.0007000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">maker</span><span class="w"> </span><span class="err">fee</span><span class="w"> </span><span class="err">rate</span><span class="w">
                </span><span class="nl">"fee_rate_taker"</span><span class="p">:</span><span class="s2">"0.0007000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">taker</span><span class="w"> </span><span class="err">fee</span><span class="w"> </span><span class="err">rate</span><span class="w">
                </span><span class="nl">"client_oid"</span><span class="p">:</span><span class="mi">1602644402806</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">client</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
                </span><span class="nl">"order_from"</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">ignore</span><span class="w">
                </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="s2">"2020-10-14T03:00:08.000Z"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">created</span><span class="w"> </span><span class="err">time</span><span class="w">
                </span><span class="nl">"updatedAt"</span><span class="p">:</span><span class="s2">"2020-10-14T03:00:08.000Z"</span><span class="err">//</span><span class="w"> </span><span class="err">updated</span><span class="w"> </span><span class="err">time</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>id</td>
<td>order id</td>
</tr>
<tr>
<td>user_id</td>
<td>user id</td>
</tr>
<tr>
<td>coin_symbol</td>
<td>coin symbol</td>
</tr>
<tr>
<td>pair</td>
<td>pair</td>
</tr>
<tr>
<td>side</td>
<td>Pending order side, 1 open long, 2 open short, 3 close long, 4 close short</td>
</tr>
<tr>
<td>order_type</td>
<td>Order type, 1 market price, 2 limit price</td>
</tr>
<tr>
<td>price</td>
<td>Pending order price</td>
</tr>
<tr>
<td>amount_coin</td>
<td>Order quantity</td>
</tr>
<tr>
<td>freeze</td>
<td>Frozen funds</td>
</tr>
<tr>
<td>price_deal</td>
<td>Average deal price</td>
</tr>
<tr>
<td>deal_coin</td>
<td>Deal amount</td>
</tr>
<tr>
<td>deal_num</td>
<td>Deal number</td>
</tr>
<tr>
<td>fee</td>
<td>fee</td>
</tr>
<tr>
<td>fee_bix</td>
<td>Token deduction</td>
</tr>
<tr>
<td>fee_bix0</td>
<td>Coupon deduction</td>
</tr>
<tr>
<td>status</td>
<td>Order status, 1 uncompleted, 2 partially completed, 3 completely completed, 4 partially cancelled, 5 completely cancelled, 100 failed to place an order</td>
</tr>
<tr>
<td>reason</td>
<td>Reason for failure</td>
</tr>
<tr>
<td>fee_rate_maker</td>
<td>maker fee rate</td>
</tr>
<tr>
<td>fee_rate_taker</td>
<td>taker fee rate</td>
</tr>
<tr>
<td>client_oid</td>
<td>client order id</td>
</tr>
<tr>
<td>order_from</td>
<td>Order source</td>
</tr>
<tr>
<td>createdAt</td>
<td>created time</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='23-query-order'>23.Query order</h2>
<blockquote>
<p>Request</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code><span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">request</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">request</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">url</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://api.trade-planets.com/api/v1/qc/order/by/id</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">"</span><span class="p">;</span> <span class="c1">//your apikey secret</span>

<span class="kd">let</span> <span class="nx">param</span> <span class="o">=</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">orderIds</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">421112953438213</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">421112953438214</span><span class="dl">"</span><span class="p">],</span>
    <span class="dl">"</span><span class="s2">clientOids</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span><span class="dl">"</span><span class="s2">1602644402806</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">1602644402811</span><span class="dl">"</span><span class="p">],</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">cmd</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">param</span><span class="p">);</span> <span class="c1">//format param</span>
<span class="kd">let</span> <span class="nx">timestamp</span> <span class="o">=</span> <span class="dl">''</span> <span class="o">+</span> <span class="p">(</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">timestamp</span> <span class="o">+</span> <span class="nx">cmd</span><span class="p">,</span> <span class="nx">secret</span><span class="p">).</span><span class="nx">toString</span><span class="p">();</span><span class="c1">//sign cmds</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">post</span><span class="p">({</span>
        <span class="na">url</span><span class="p">:</span> <span class="nx">url</span><span class="p">,</span><span class="c1">//Request path</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span><span class="c1">//Request method</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span><span class="c1">//Set request headers</span>
            <span class="dl">'</span><span class="s1">content-type</span><span class="dl">'</span><span class="p">:</span> <span class="dl">'</span><span class="s1">application/json</span><span class="dl">'</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-key</span><span class="dl">'</span><span class="p">:</span> <span class="nx">apikey</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-sign</span><span class="dl">'</span><span class="p">:</span> <span class="nx">sign</span><span class="p">,</span>
            <span class="dl">'</span><span class="s1">api-timestamp</span><span class="dl">'</span><span class="p">:</span> <span class="nx">timestamp</span>
        <span class="p">},</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">cmd</span><span class="c1">//parameter string</span>
    <span class="p">},</span>

    <span class="kd">function</span> <span class="nx">optionalCallback</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">httpResponse</span><span class="p">,</span> <span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="dl">'</span><span class="s1">upload failed:</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">body</span><span class="p">)</span>

    <span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># -*- coding:utf-8 -*-
</span><span class="kn">import</span> <span class="nn">hashlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">sys</span><span class="p">,</span> <span class="n">getopt</span>

<span class="n">API_KEY</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>
<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s">'https://api.trade-planets.com'</span>  


<span class="k">def</span> <span class="nf">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">):</span>
    <span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">())</span> <span class="o">*</span> <span class="mi">1000</span>
    <span class="c1"># to_sign = str(timestamp)+json.dumps(body,separators=(',',':'))
</span>    <span class="n">to_sign</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span> <span class="o">+</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">SECRET_KEY</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">to_sign</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="n">to_sign</span><span class="p">)</span>

    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'api-key'</span><span class="p">:</span> <span class="n">API_KEY</span><span class="p">,</span>
        <span class="s">'api-sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'api-timestamp'</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">headers</span>


<span class="k">def</span> <span class="nf">get_baseu_order_by_id</span><span class="p">():</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s">'/api/v1/qc/order/by/id'</span>
    <span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">"orderIds"</span><span class="p">:</span> <span class="p">[</span><span class="s">"421112953438213"</span><span class="p">,</span> <span class="s">"421112953438214"</span><span class="p">],</span>
        <span class="s">"clientOids"</span><span class="p">:</span> <span class="p">[</span><span class="s">"1602644402806"</span><span class="p">,</span> <span class="s">"1602644402811"</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="n">do_sign</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">BASE_URL</span> <span class="o">+</span> <span class="n">path</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="n">resp</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">get_baseu_order_by_id</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">ConsoleProgram</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">class</span> <span class="nc">Class1</span>
    <span class="p">{</span>

        <span class="c1">// HttpClient is intended to be instantiated once per application, rather than per-use. See Remarks.</span>
        <span class="k">static</span> <span class="k">readonly</span> <span class="n">HttpClient</span> <span class="n">client</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HttpClient</span><span class="p">();</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">GetTimeStamp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">TimeSpan</span> <span class="n">ts</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="n">UtcNow</span> <span class="p">-</span> <span class="k">new</span> <span class="nf">DateTime</span><span class="p">(</span><span class="m">1970</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">Convert</span><span class="p">.</span><span class="nf">ToInt64</span><span class="p">(</span><span class="n">ts</span><span class="p">.</span><span class="n">TotalMilliseconds</span><span class="p">).</span><span class="nf">ToString</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
               <span class="p">{</span>
                   <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
                   <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
                   <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

                   <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
                   <span class="p">{</span>
                       <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
                   <span class="p">}</span>

                   <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

                   <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
               <span class="p">}</span>

        <span class="k">static</span> <span class="k">async</span> <span class="n">Task</span> <span class="nf">Main</span><span class="p">()</span>
        <span class="p">{</span>
          <span class="c1">// Call asynchronous network methods in a try/catch block to handle exceptions.</span>
          <span class="k">try</span>
          <span class="p">{</span>
             <span class="kt">string</span> <span class="n">uri</span> <span class="p">=</span> <span class="s">"https://api.trade-planets.com/api/v1/qc/order/by/id"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

             <span class="kt">string</span> <span class="n">timestamp</span> <span class="p">=</span> <span class="nf">GetTimeStamp</span><span class="p">();</span>
             <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
                 <span class="n">orderIds</span> <span class="p">=</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span><span class="s">"421112953438213"</span><span class="p">,</span> <span class="s">"421112953438214"</span><span class="p">},</span>
                 <span class="n">clientOids</span> <span class="p">=</span> <span class="k">new</span> <span class="p">[]</span> <span class="p">{</span><span class="s">"1602644402806"</span><span class="p">,</span> <span class="s">"1602644402811"</span><span class="p">},</span>
             <span class="p">};</span>

             <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

             <span class="kt">string</span> <span class="n">source</span> <span class="p">=</span> <span class="n">timestamp</span> <span class="p">+</span> <span class="n">payload</span><span class="p">;</span>
             <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">sign</span><span class="p">);</span>

             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-key"</span><span class="p">,</span> <span class="n">apikey</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-sign"</span><span class="p">,</span> <span class="n">sign</span><span class="p">);</span>
             <span class="n">client</span><span class="p">.</span><span class="n">DefaultRequestHeaders</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="s">"api-timestamp"</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">);</span>

             <span class="n">HttpContent</span> <span class="n">content</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringContent</span><span class="p">(</span><span class="n">payload</span><span class="p">,</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">);</span>

             <span class="n">HttpResponseMessage</span> <span class="n">response</span> <span class="p">=</span> <span class="k">await</span> <span class="n">client</span><span class="p">.</span><span class="nf">PostAsync</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">content</span><span class="p">);</span>
             <span class="n">response</span><span class="p">.</span><span class="nf">EnsureSuccessStatusCode</span><span class="p">();</span>
             <span class="kt">string</span> <span class="n">responseBody</span> <span class="p">=</span> <span class="k">await</span> <span class="n">response</span><span class="p">.</span><span class="n">Content</span><span class="p">.</span><span class="nf">ReadAsStringAsync</span><span class="p">();</span>

             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">responseBody</span><span class="p">);</span>
          <span class="p">}</span>
          <span class="k">catch</span><span class="p">(</span><span class="n">HttpRequestException</span> <span class="n">e</span><span class="p">)</span>
          <span class="p">{</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"\nException Caught!"</span><span class="p">);</span>
             <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Message :{0} "</span><span class="p">,</span><span class="n">e</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
          <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>POST https://api.trade-planets.com/api/v1/qc/order/by/id</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>orderIds</td>
<td>true</td>
<td>Array</td>
<td>Order id array</td>
<td></td>
<td></td>
</tr>
<tr>
<td>clientOids</td>
<td>true</td>
<td>Array</td>
<td>Array of client order id</td>
<td></td>
<td></td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">421112953438214</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
            </span><span class="nl">"user_id"</span><span class="p">:</span><span class="mi">100006</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">user</span><span class="w"> </span><span class="err">id</span><span class="w">
            </span><span class="nl">"coin_symbol"</span><span class="p">:</span><span class="s2">"USDT"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">coin</span><span class="w"> </span><span class="err">symbol</span><span class="w">
            </span><span class="nl">"pair"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">pair</span><span class="w">
            </span><span class="nl">"side"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">side</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">long</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">short</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">close</span><span class="w"> </span><span class="err">long</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">close</span><span class="w"> </span><span class="err">short</span><span class="w">
            </span><span class="nl">"order_type"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">type</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">market</span><span class="w"> </span><span class="err">price</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">limit</span><span class="w"> </span><span class="err">price</span><span class="w">
            </span><span class="nl">"price"</span><span class="p">:</span><span class="s2">"11692.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Pending</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">price</span><span class="w">
            </span><span class="nl">"amount_coin"</span><span class="p">:</span><span class="s2">"1.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">quantity</span><span class="w">
            </span><span class="nl">"freeze"</span><span class="p">:</span><span class="s2">"0.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Frozen</span><span class="w"> </span><span class="err">funds</span><span class="w">
            </span><span class="nl">"price_deal"</span><span class="p">:</span><span class="s2">"11692.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Average</span><span class="w"> </span><span class="err">deal</span><span class="w"> </span><span class="err">price</span><span class="w">
            </span><span class="nl">"deal_coin"</span><span class="p">:</span><span class="s2">"1.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Deal</span><span class="w"> </span><span class="err">amount</span><span class="w">
            </span><span class="nl">"deal_num"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Deal</span><span class="w"> </span><span class="err">number</span><span class="w">
            </span><span class="nl">"fee"</span><span class="p">:</span><span class="s2">"0.0000000599"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">fee</span><span class="w">
            </span><span class="nl">"fee_bix"</span><span class="p">:</span><span class="s2">"0.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Token</span><span class="w"> </span><span class="err">deduction</span><span class="w">
            </span><span class="nl">"fee_bix0"</span><span class="p">:</span><span class="s2">"0.0000000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Coupon</span><span class="w"> </span><span class="err">deduction</span><span class="w">
            </span><span class="nl">"status"</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">status</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">uncompleted</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">partially</span><span class="w"> </span><span class="err">completed</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">completely</span><span class="w"> </span><span class="err">completed</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">partially</span><span class="w"> </span><span class="err">cancelled</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="err">completely</span><span class="w"> </span><span class="err">cancelled</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="err">failed</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">place</span><span class="w"> </span><span class="err">an</span><span class="w"> </span><span class="err">order</span><span class="w">
            </span><span class="nl">"reason"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Reason</span><span class="w"> </span><span class="err">for</span><span class="w"> </span><span class="err">failure</span><span class="w">
            </span><span class="nl">"fee_rate_maker"</span><span class="p">:</span><span class="s2">"0.0007000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">maker</span><span class="w"> </span><span class="err">fee</span><span class="w"> </span><span class="err">rate</span><span class="w">
            </span><span class="nl">"fee_rate_taker"</span><span class="p">:</span><span class="s2">"0.0007000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">taker</span><span class="w"> </span><span class="err">fee</span><span class="w"> </span><span class="err">rate</span><span class="w">
            </span><span class="nl">"client_oid"</span><span class="p">:</span><span class="mi">1602644402806</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">client</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
            </span><span class="nl">"order_from"</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">ignore</span><span class="w">
            </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="s2">"2020-10-14T03:00:08.000Z"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">created</span><span class="w"> </span><span class="err">time</span><span class="w">
            </span><span class="nl">"updatedAt"</span><span class="p">:</span><span class="s2">"2020-10-14T03:00:08.000Z"</span><span class="err">//</span><span class="w"> </span><span class="err">updated</span><span class="w"> </span><span class="err">time</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="err">...</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>id</td>
<td>order id</td>
</tr>
<tr>
<td>user_id</td>
<td>user id</td>
</tr>
<tr>
<td>coin_symbol</td>
<td>coin symbol</td>
</tr>
<tr>
<td>pair</td>
<td>pair</td>
</tr>
<tr>
<td>side</td>
<td>Pending order side, 1 open long, 2 open short, 3 close long, 4 close short</td>
</tr>
<tr>
<td>order_type</td>
<td>Order type, 1 market price, 2 limit price</td>
</tr>
<tr>
<td>price</td>
<td>Pending order price</td>
</tr>
<tr>
<td>amount_coin</td>
<td>Order quantity</td>
</tr>
<tr>
<td>freeze</td>
<td>Frozen funds</td>
</tr>
<tr>
<td>price_deal</td>
<td>Average deal price</td>
</tr>
<tr>
<td>deal_coin</td>
<td>Deal amount</td>
</tr>
<tr>
<td>deal_num</td>
<td>Deal number</td>
</tr>
<tr>
<td>fee</td>
<td>fee</td>
</tr>
<tr>
<td>fee_bix</td>
<td>Token deduction</td>
</tr>
<tr>
<td>fee_bix0</td>
<td>Coupon deduction</td>
</tr>
<tr>
<td>status</td>
<td>Order status, 1 uncompleted, 2 partially completed, 3 completely completed, 4 partially cancelled, 5 completely cancelled, 100 failed to place an order</td>
</tr>
<tr>
<td>reason</td>
<td>Reason for failure</td>
</tr>
<tr>
<td>fee_rate_maker</td>
<td>maker fee rate</td>
</tr>
<tr>
<td>fee_rate_taker</td>
<td>taker fee rate</td>
</tr>
<tr>
<td>client_oid</td>
<td>client order id</td>
</tr>
<tr>
<td>order_from</td>
<td>Order source</td>
</tr>
<tr>
<td>createdAt</td>
<td>created time</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='24-qeury-fund-fee-rate'>24.Qeury fund fee rate</h2>
<ul>
<li>1.Request path</li>
</ul>

<p>GET https://api.trade-planets.com/api/v1/qc/fund/rate</p>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"4BTC_USDT"</span><span class="p">:{</span><span class="w">
            </span><span class="nl">"pair"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"close"</span><span class="p">:</span><span class="s2">"0.0000000000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"fund_rate"</span><span class="p">:</span><span class="s2">"0.0001000000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="s2">"2020-10-14T00:00:00.000Z"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"4ETH_USDT"</span><span class="p">:{</span><span class="w">
            </span><span class="nl">"pair"</span><span class="p">:</span><span class="s2">"4ETH_USDT"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"close"</span><span class="p">:</span><span class="s2">"0.0000000000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"fund_rate"</span><span class="p">:</span><span class="s2">"0.0001000000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="s2">"2020-10-14T00:00:00.000Z"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>2.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>pair</td>
<td>pair</td>
</tr>
<tr>
<td>fund_rate</td>
<td>fund fee rate</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='25-qeury-tag-price'>25.Qeury tag price</h2>
<ul>
<li>1.Request path</li>
</ul>

<p>GET https://api.trade-planets.com/api/v1/qc/tag/price</p>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"4BTC_USDT"</span><span class="p">:{</span><span class="err">//pair</span><span class="w">
            </span><span class="nl">"close"</span><span class="p">:</span><span class="s2">"11453.7224909000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Index</span><span class="w"> </span><span class="err">price</span><span class="w">
            </span><span class="nl">"priceTag"</span><span class="p">:</span><span class="s2">"11454.2951770245"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Tag</span><span class="w"> </span><span class="err">price</span><span class="w">
            </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="s2">"2020-10-14T03:41:08.000Z"</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">time</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"4ETH_USDT"</span><span class="p">:{</span><span class="w">
            </span><span class="nl">"close"</span><span class="p">:</span><span class="s2">"383.1999999600"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"priceTag"</span><span class="p">:</span><span class="s2">"383.2191599600"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"createdAt"</span><span class="p">:</span><span class="s2">"2020-10-14T03:41:08.000Z"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>2.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>result</td>
<td>The keyword is pair</td>
</tr>
<tr>
<td>close</td>
<td>Index price</td>
</tr>
<tr>
<td>priceTag</td>
<td>Tag price</td>
</tr>
<tr>
<td>createdAt</td>
<td>time</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='26-query-basic-contract-information'>26.Query basic contract information</h2>
<ul>
<li>1.Request path</li>
</ul>

<p>GET https://api.trade-planets.com/api/v1/qc/value</p>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"id"</span><span class="p">:</span><span class="mi">304</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pair"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"coin_symbol"</span><span class="p">:</span><span class="s2">"USDT"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"leverage_init"</span><span class="p">:</span><span class="s2">"10.0000000000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"leverage_min"</span><span class="p">:</span><span class="s2">"0.0100000000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"leverage_max"</span><span class="p">:</span><span class="s2">"150.0000000000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"value"</span><span class="p">:</span><span class="s2">"0.0001000000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"risk_level_base"</span><span class="p">:</span><span class="s2">"1.0000000000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"risk_level_dx"</span><span class="p">:</span><span class="s2">"1.0000000000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"maker_fee"</span><span class="p">:</span><span class="s2">"0.0002000000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"taker_fee"</span><span class="p">:</span><span class="s2">"0.0005500000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"open_max_per"</span><span class="p">:</span><span class="s2">"100.0000000000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pending_max"</span><span class="p">:</span><span class="mi">100</span><span class="p">,</span><span class="w">
            </span><span class="nl">"hold_max"</span><span class="p">:</span><span class="s2">"100.0000000000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"price_precision"</span><span class="p">:</span><span class="mi">1</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="err">...</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>2.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>pair</td>
<td>pair</td>
</tr>
<tr>
<td>leverage_min</td>
<td>Minimum leverage</td>
</tr>
<tr>
<td>leverage_max</td>
<td>Maximum leverage</td>
</tr>
<tr>
<td>value</td>
<td>contract value</td>
</tr>
<tr>
<td>maker_fee</td>
<td>default maker fee rate</td>
</tr>
<tr>
<td>taker_fee</td>
<td>default taker fee rate</td>
</tr>
<tr>
<td>open_max_per</td>
<td>Maximum number of single pending orders</td>
</tr>
<tr>
<td>pending_max</td>
<td>Maximum number of pending orders</td>
</tr>
<tr>
<td>hold_max</td>
<td>Maximum position value</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='27-query-accuracy-configuration'>27.Query accuracy configuration</h2>
<ul>
<li>1.Request path</li>
</ul>

<p>GET https://api.trade-planets.com/api/v1/qc/unit</p>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"pair"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="err">//pair</span><span class="w">
            </span><span class="nl">"price_unit"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="err">//Decimal</span><span class="w"> </span><span class="err">points</span><span class="w"> </span><span class="err">for</span><span class="w"> </span><span class="err">order</span><span class="w">
            </span><span class="nl">"vol_unit"</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">ignore</span><span class="w">
            </span><span class="nl">"value_unit"</span><span class="p">:</span><span class="mi">0</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">ignore</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="err">...</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"state"</span><span class="p">:</span><span class="mi">0</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>2.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>state</td>
<td>0 means success, otherwise means failure</td>
</tr>
<tr>
<td>pair</td>
<td>pair</td>
</tr>
<tr>
<td>price_unit</td>
<td>Decimal points for order</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='28-query-kline'>28.Query Kline</h2>
<ul>
<li><p>1.Request path</p></li>
<li><p>GET https://api.trade-planets.com/api/v1/mudata/kline?pair=4BTC_USDT&amp;period=1min&amp;size=10</p></li>
<li><p>2.Request parameter</p></li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>true</td>
<td>string</td>
<td>pair</td>
<td></td>
<td>4BTC_USDT, 4ETH_USDT, ...</td>
</tr>
<tr>
<td>period</td>
<td>true</td>
<td>string</td>
<td>k-line period</td>
<td></td>
<td>&#39;1min&#39;, &#39;3min&#39;, &#39;5min&#39;, &#39;15min&#39;, &#39;30min&#39;, &#39;1hour&#39;, &#39;2hour&#39;, &#39;4hour&#39;, &#39;6hour&#39;, &#39;12hour&#39;, &#39;day&#39;, &#39;week&#39;</td>
</tr>
<tr>
<td>size</td>
<td>false</td>
<td>integer</td>
<td>size</td>
<td>1000</td>
<td>1-1000</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"time"</span><span class="p">:</span><span class="mi">1602680580000</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Timestamp</span><span class="w">
            </span><span class="nl">"open"</span><span class="p">:</span><span class="s2">"10666.00000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Opening</span><span class="w"> </span><span class="err">price</span><span class="w">
            </span><span class="nl">"high"</span><span class="p">:</span><span class="s2">"10666.00000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Highest</span><span class="w"> </span><span class="err">price</span><span class="w">
            </span><span class="nl">"low"</span><span class="p">:</span><span class="s2">"10666.00000000"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">Lowest</span><span class="w"> </span><span class="err">price</span><span class="w">
            </span><span class="nl">"close"</span><span class="p">:</span><span class="s2">"10666.00000000"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Closing</span><span class="w"> </span><span class="err">price</span><span class="w">
            </span><span class="nl">"vol"</span><span class="p">:</span><span class="s2">"0.00000000"</span><span class="err">//</span><span class="w"> </span><span class="err">Volume</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="err">...</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"kline"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ver"</span><span class="p">:</span><span class="s2">"2.0"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>result</td>
<td>Value means success, otherwise means failure</td>
</tr>
<tr>
<td>time</td>
<td>Timestamp</td>
</tr>
<tr>
<td>open</td>
<td>Opening price</td>
</tr>
<tr>
<td>high</td>
<td>Highest price</td>
</tr>
<tr>
<td>low</td>
<td>Lowest price</td>
</tr>
<tr>
<td>close</td>
<td>Closing price</td>
</tr>
<tr>
<td>vol</td>
<td>Volume</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='29-query-market-depth'>29.Query market depth</h2>
<ul>
<li>1.Request path</li>
</ul>

<p>GET https://api.trade-planets.com/api/v1/mudata/depth?pair=4BTC_USDT&amp;size=10</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>true</td>
<td>string</td>
<td>pair</td>
<td></td>
<td>4BTC_USDT, 4ETH_USDT, ...</td>
</tr>
<tr>
<td>size</td>
<td>false</td>
<td>integer</td>
<td>size</td>
<td>200</td>
<td>1-200</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"result"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"pair"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"update_time"</span><span class="p">:</span><span class="mi">1602669350668</span><span class="p">,</span><span class="w">
        </span><span class="nl">"asks"</span><span class="p">:[</span><span class="err">//Seller</span><span class="w"> </span><span class="err">Depth</span><span class="w"> </span><span class="err">of</span><span class="w"> </span><span class="err">Market</span><span class="w">

        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"bids"</span><span class="p">:[</span><span class="err">//Buyer</span><span class="w"> </span><span class="err">market</span><span class="w"> </span><span class="err">depth</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"volume"</span><span class="p">:</span><span class="s2">"54054"</span><span class="p">,</span><span class="err">//Order</span><span class="w"> </span><span class="err">quantity</span><span class="w">
                </span><span class="nl">"price"</span><span class="p">:</span><span class="s2">"10666"</span><span class="err">//Pending</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">price</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="err">...</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"cmd"</span><span class="p">:</span><span class="s2">"depth"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"ver"</span><span class="p">:</span><span class="s2">"2.0"</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>result</td>
<td>Value means success, otherwise means failure</td>
</tr>
<tr>
<td>pair</td>
<td>pair</td>
</tr>
<tr>
<td>update_time</td>
<td>time</td>
</tr>
<tr>
<td>asks</td>
<td>Seller Depth of Market</td>
</tr>
<tr>
<td>bids</td>
<td>Buyer market depth</td>
</tr>
<tr>
<td>volume</td>
<td>Order quantity</td>
</tr>
<tr>
<td>price</td>
<td>Pending order price</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='30-subscription-to-kline'>30.Subscription to Kline</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code>
<span class="kd">const</span> <span class="nx">WebSocket</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">ws</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">zlib</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">zlib</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">biboxws</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">wss://push.trade-planets.com/cbu</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">wsClass</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

<span class="p">};</span>

<span class="nx">wsClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_decodeMsg</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">data1</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
    <span class="nx">zlib</span><span class="p">.</span><span class="nx">unzip</span><span class="p">(</span><span class="nx">data1</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">buffer</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="kd">let</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">};</span>

<span class="nx">wsClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_initWs</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">biboxws</span><span class="p">)</span>
    <span class="kd">let</span> <span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebSocket</span><span class="p">(</span><span class="nx">biboxws</span><span class="p">);</span>
    <span class="nx">that</span><span class="p">.</span><span class="nx">ws</span> <span class="o">=</span> <span class="nx">ws</span><span class="p">;</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">open</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">)</span>
        <span class="p">{</span><span class="c1">// kline</span>
            <span class="nx">ws</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
                <span class="na">event</span><span class="p">:</span> <span class="dl">'</span><span class="s1">addChannel</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">sub</span><span class="p">:</span> <span class="dl">'</span><span class="s1">4BTC_USDT_kline_1min</span><span class="dl">'</span><span class="p">,</span>
            <span class="p">}));</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">close</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">close, </span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping </span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong </span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">_decodeMsg</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">0</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">)));</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="nx">data</span><span class="p">);</span>
        <span class="p">}</span>

    <span class="p">});</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">wsClass</span><span class="p">();</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">_initWs</span><span class="p">().</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># /usr/bin/env python
# -*- coding: UTF-8 -*-
</span>
<span class="kn">import</span> <span class="nn">websocket</span> <span class="c1"># websocket-client
</span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">zlib</span>

<span class="n">ws_url</span> <span class="o">=</span> <span class="s">'wss://push.trade-planets.com/cbu'</span>


<span class="k">def</span> <span class="nf">stringify</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">"</span><span class="se">\'</span><span class="s">"</span><span class="p">,</span> <span class="s">"</span><span class="se">\"</span><span class="s">"</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">" "</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_sub_str</span><span class="p">():</span>
    <span class="n">subdata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'sub'</span><span class="p">:</span> <span class="s">'4BTC_USDT_kline_1min'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="c1"># print(stringify(subdata))
</span>    <span class="k">return</span> <span class="n">stringify</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_unsub_str</span><span class="p">():</span>
    <span class="n">subdata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'unsub'</span><span class="p">:</span> <span class="s">'4BTC_USDT_kline_1min'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">stringify</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">decode_data</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">'</span><span class="se">\x01</span><span class="s">'</span> <span class="ow">or</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">zlib</span><span class="p">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">zlib</span><span class="p">.</span><span class="n">MAX_WBITS</span> <span class="o">|</span> <span class="mi">32</span><span class="p">)</span>
        <span class="n">jmsgs</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">'</span><span class="se">\x00</span><span class="s">'</span> <span class="ow">or</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">jmsgs</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">jmsgs</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="c1"># print(message)
</span>    <span class="n">decode_data</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_error</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"### closed ###"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_open</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">get_sub_str</span><span class="p">())</span>


<span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
    <span class="n">websocket</span><span class="p">.</span><span class="n">enableTrace</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ws</span> <span class="o">=</span> <span class="n">websocket</span><span class="p">.</span><span class="n">WebSocketApp</span><span class="p">(</span><span class="n">ws_url</span><span class="p">,</span>
                                <span class="n">on_message</span><span class="o">=</span><span class="n">on_message</span><span class="p">,</span>
                                <span class="n">on_error</span><span class="o">=</span><span class="n">on_error</span><span class="p">,</span>
                                <span class="n">on_close</span><span class="o">=</span><span class="n">on_close</span><span class="p">)</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">on_open</span> <span class="o">=</span> <span class="n">on_open</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">run_forever</span><span class="p">(</span><span class="n">ping_interval</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ping_timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">connect</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">WebSocketSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO.Compression</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Example</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

  <span class="k">public</span> <span class="k">class</span> <span class="nc">Program</span>
  <span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">Decompress</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">bytes</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">MemoryStream</span> <span class="n">msIn</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">bytes</span><span class="p">.</span><span class="n">Length</span> <span class="p">-</span> <span class="m">1</span><span class="p">);</span>
        <span class="n">MemoryStream</span> <span class="n">msOut</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">();</span>

        <span class="n">GZipStream</span> <span class="n">cprs</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GZipStream</span><span class="p">(</span><span class="n">msIn</span><span class="p">,</span> <span class="n">CompressionMode</span><span class="p">.</span><span class="n">Decompress</span><span class="p">);</span>
        <span class="n">cprs</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="n">msOut</span><span class="p">);</span>
        <span class="n">cprs</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>

        <span class="k">return</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetString</span><span class="p">(</span><span class="n">msOut</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">());</span><span class="c1">//转换为普通的字符串</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="kt">string</span> <span class="n">wsuri</span> <span class="p">=</span> <span class="s">"wss://push.trade-planets.com/cbu"</span><span class="p">;</span>
      <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">ws</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WebSocket</span> <span class="p">(</span><span class="n">wsuri</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">ws</span><span class="p">.</span><span class="n">OnMessage</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>

            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"recv: "</span> <span class="p">+</span> <span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">IsText</span><span class="p">)</span> <span class="p">{</span>
              <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"data[0]: {"</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">IsBinary</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"RawData[0]: 1"</span><span class="p">);</span>
                    <span class="kt">string</span> <span class="n">strres</span> <span class="p">=</span> <span class="nf">Decompress</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="n">strres</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"RawData[0]: 0"</span><span class="p">);</span>
                    <span class="kt">string</span> <span class="n">strres</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetString</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="n">strres</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>

        <span class="p">};</span>

        <span class="n">ws</span><span class="p">.</span><span class="nf">Connect</span> <span class="p">();</span>

        <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
            <span class="n">sub</span> <span class="p">=</span> <span class="s">"4BTC_USDT_kline_1min"</span><span class="p">,</span>
        <span class="p">};</span>

        <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

        <span class="n">ws</span><span class="p">.</span><span class="nf">Send</span> <span class="p">(</span><span class="n">payload</span><span class="p">);</span>

        <span class="n">ConsoleKey</span> <span class="n">key</span><span class="p">;</span>
        <span class="k">do</span>
    <span class="err">　　</span><span class="p">{</span>
    <span class="err">　　</span>      <span class="n">key</span><span class="p">=</span><span class="n">Console</span><span class="p">.</span><span class="nf">ReadKey</span><span class="p">().</span><span class="n">Key</span><span class="p">;</span>
    <span class="err">　　</span>
    <span class="err">　　</span><span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">key</span> <span class="p">!=</span> <span class="n">ConsoleKey</span><span class="p">.</span><span class="n">Q</span><span class="p">);</span>

      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Subscription path</li>
</ul>

<p>wss://push.trade-planets.com/cbu</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>true</td>
<td>string</td>
<td>pair</td>
<td></td>
<td>4BTC_USDT, 4ETH_USDT</td>
</tr>
<tr>
<td>period</td>
<td>true</td>
<td>string</td>
<td>k-line period</td>
<td></td>
<td>1min, 5min, 15min, 30min, 1hour, 2hour, 4hour, 6hour, 12hour, day, week</td>
</tr>
<tr>
<td>sub</td>
<td>true</td>
<td>string</td>
<td></td>
<td></td>
<td>${pair} + &#39;_kline_&#39; + ${period}</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">topic:</span><span class="w"> </span><span class="err">'</span><span class="mi">4</span><span class="err">BTC_USDT_kline_</span><span class="mi">1</span><span class="err">min'</span><span class="p">,</span><span class="w">
  </span><span class="err">t:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="err">d:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="err">'</span><span class="mi">1639122420000</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">47868.1</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">47892.3</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">47825.4</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">47825.4</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">10.86</span><span class="err">'</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="err">'</span><span class="mi">1639122480000</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">47825.4</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">47830.9</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">47728.7</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">47775.6</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">10.88</span><span class="err">'</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<p>[
k-line start time,
Deal number,
Opening price,
Highest price,
Lowest price,
Closing price,
Volume(Contract value)
]</p>
<h2 id='31-subscription-to-tag-price'>31.Subscription to Tag price</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code>
<span class="kd">const</span> <span class="nx">WebSocket</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">ws</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">zlib</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">zlib</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">biboxws</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">wss://push.trade-planets.com/cbu</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">wsClass</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

<span class="p">};</span>

<span class="nx">wsClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_decodeMsg</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">data1</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
    <span class="nx">zlib</span><span class="p">.</span><span class="nx">unzip</span><span class="p">(</span><span class="nx">data1</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">buffer</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="kd">let</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">};</span>

<span class="nx">wsClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_initWs</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">biboxws</span><span class="p">)</span>
    <span class="kd">let</span> <span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebSocket</span><span class="p">(</span><span class="nx">biboxws</span><span class="p">);</span>
    <span class="nx">that</span><span class="p">.</span><span class="nx">ws</span> <span class="o">=</span> <span class="nx">ws</span><span class="p">;</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">open</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">)</span>
        <span class="p">{</span><span class="c1">// kline</span>
            <span class="nx">ws</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
                <span class="na">event</span><span class="p">:</span> <span class="dl">'</span><span class="s1">addChannel</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">sub</span><span class="p">:</span> <span class="dl">'</span><span class="s1">4BTC_USDTTAGPRICE_kline_1min</span><span class="dl">'</span><span class="p">,</span>
            <span class="p">}));</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">close</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">close, </span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping </span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong </span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">_decodeMsg</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">0</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">)));</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="nx">data</span><span class="p">);</span>
        <span class="p">}</span>

    <span class="p">});</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">wsClass</span><span class="p">();</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">_initWs</span><span class="p">().</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># /usr/bin/env python
# -*- coding: UTF-8 -*-
</span>
<span class="kn">import</span> <span class="nn">websocket</span> <span class="c1"># websocket-client
</span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">zlib</span>

<span class="n">ws_url</span> <span class="o">=</span> <span class="s">'wss://push.trade-planets.com/cbu'</span>


<span class="k">def</span> <span class="nf">stringify</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">"</span><span class="se">\'</span><span class="s">"</span><span class="p">,</span> <span class="s">"</span><span class="se">\"</span><span class="s">"</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">" "</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_sub_str</span><span class="p">():</span>
    <span class="n">subdata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'sub'</span><span class="p">:</span> <span class="s">'4BTC_USDTTAGPRICE_kline_1min'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="c1"># print(stringify(subdata))
</span>    <span class="k">return</span> <span class="n">stringify</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_unsub_str</span><span class="p">():</span>
    <span class="n">subdata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'unsub'</span><span class="p">:</span> <span class="s">'4BTC_USDTTAGPRICE_kline_1min'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">stringify</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">decode_data</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">'</span><span class="se">\x01</span><span class="s">'</span> <span class="ow">or</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">zlib</span><span class="p">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">zlib</span><span class="p">.</span><span class="n">MAX_WBITS</span> <span class="o">|</span> <span class="mi">32</span><span class="p">)</span>
        <span class="n">jmsgs</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">'</span><span class="se">\x00</span><span class="s">'</span> <span class="ow">or</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">jmsgs</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">jmsgs</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="c1"># print(message)
</span>    <span class="n">decode_data</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_error</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"### closed ###"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_open</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">get_sub_str</span><span class="p">())</span>


<span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
    <span class="n">websocket</span><span class="p">.</span><span class="n">enableTrace</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ws</span> <span class="o">=</span> <span class="n">websocket</span><span class="p">.</span><span class="n">WebSocketApp</span><span class="p">(</span><span class="n">ws_url</span><span class="p">,</span>
                                <span class="n">on_message</span><span class="o">=</span><span class="n">on_message</span><span class="p">,</span>
                                <span class="n">on_error</span><span class="o">=</span><span class="n">on_error</span><span class="p">,</span>
                                <span class="n">on_close</span><span class="o">=</span><span class="n">on_close</span><span class="p">)</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">on_open</span> <span class="o">=</span> <span class="n">on_open</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">run_forever</span><span class="p">(</span><span class="n">ping_interval</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ping_timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">connect</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">WebSocketSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO.Compression</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Example</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

  <span class="k">public</span> <span class="k">class</span> <span class="nc">Program</span>
  <span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">Decompress</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">bytes</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">MemoryStream</span> <span class="n">msIn</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">bytes</span><span class="p">.</span><span class="n">Length</span> <span class="p">-</span> <span class="m">1</span><span class="p">);</span>
        <span class="n">MemoryStream</span> <span class="n">msOut</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">();</span>

        <span class="n">GZipStream</span> <span class="n">cprs</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GZipStream</span><span class="p">(</span><span class="n">msIn</span><span class="p">,</span> <span class="n">CompressionMode</span><span class="p">.</span><span class="n">Decompress</span><span class="p">);</span>
        <span class="n">cprs</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="n">msOut</span><span class="p">);</span>
        <span class="n">cprs</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>

        <span class="k">return</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetString</span><span class="p">(</span><span class="n">msOut</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">());</span><span class="c1">//转换为普通的字符串</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="kt">string</span> <span class="n">wsuri</span> <span class="p">=</span> <span class="s">"wss://push.trade-planets.com/cbu"</span><span class="p">;</span>
      <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">ws</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WebSocket</span> <span class="p">(</span><span class="n">wsuri</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">ws</span><span class="p">.</span><span class="n">OnMessage</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>

            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"recv: "</span> <span class="p">+</span> <span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">IsText</span><span class="p">)</span> <span class="p">{</span>
              <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"data[0]: {"</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">IsBinary</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"RawData[0]: 1"</span><span class="p">);</span>
                    <span class="kt">string</span> <span class="n">strres</span> <span class="p">=</span> <span class="nf">Decompress</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="n">strres</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"RawData[0]: 0"</span><span class="p">);</span>
                    <span class="kt">string</span> <span class="n">strres</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetString</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="n">strres</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>

        <span class="p">};</span>

        <span class="n">ws</span><span class="p">.</span><span class="nf">Connect</span> <span class="p">();</span>

        <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
            <span class="n">sub</span> <span class="p">=</span> <span class="s">"4BTC_USDTTAGPRICE_kline_1min"</span><span class="p">,</span>
        <span class="p">};</span>

        <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

        <span class="n">ws</span><span class="p">.</span><span class="nf">Send</span> <span class="p">(</span><span class="n">payload</span><span class="p">);</span>

        <span class="n">ConsoleKey</span> <span class="n">key</span><span class="p">;</span>
        <span class="k">do</span>
    <span class="err">　　</span><span class="p">{</span>
    <span class="err">　　</span>      <span class="n">key</span><span class="p">=</span><span class="n">Console</span><span class="p">.</span><span class="nf">ReadKey</span><span class="p">().</span><span class="n">Key</span><span class="p">;</span>
    <span class="err">　　</span>
    <span class="err">　　</span><span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">key</span> <span class="p">!=</span> <span class="n">ConsoleKey</span><span class="p">.</span><span class="n">Q</span><span class="p">);</span>

      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Subscription path</li>
</ul>

<p>wss://push.trade-planets.com/cbu</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>true</td>
<td>string</td>
<td>pair</td>
<td></td>
<td>4BTC_USDT, 4ETH_USDT</td>
</tr>
<tr>
<td>sub</td>
<td>true</td>
<td>string</td>
<td></td>
<td></td>
<td>${pair} + &#39;TAGPRICE_kline_1min&#39;</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="err">topic:</span><span class="w"> </span><span class="err">'</span><span class="mi">4</span><span class="err">BTC_USDTTAGPRICE_kline_</span><span class="mi">1</span><span class="err">min'</span><span class="p">,</span><span class="w">
  </span><span class="err">t:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="err">d:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="err">'</span><span class="mi">1639123440000</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">47744.46219748</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">47744.46219748</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">47678.11820096</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">47685.89214597</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mi">30</span><span class="err">'</span><span class="w">
    </span><span class="p">],</span><span class="w">
    </span><span class="p">[</span><span class="w">
      </span><span class="err">'</span><span class="mi">1639123500000</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">47683.92095634</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">47707.9817466</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">47683.25428563</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mf">47705.7285557</span><span class="err">'</span><span class="p">,</span><span class="w">
      </span><span class="err">'</span><span class="mi">28</span><span class="err">'</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<p>[
k-line start time,
Deal number,
Opening price,
Highest price,
Lowest price,
Latest price,
Volume(ignore)
]</p>
<h2 id='32-subscription-to-market-depth'>32.Subscription to Market depth</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code>
<span class="kd">const</span> <span class="nx">WebSocket</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">ws</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">zlib</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">zlib</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">biboxws</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">wss://push.trade-planets.com/cbu</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">wsClass</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

<span class="p">};</span>

<span class="nx">wsClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_decodeMsg</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">data1</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
    <span class="nx">zlib</span><span class="p">.</span><span class="nx">unzip</span><span class="p">(</span><span class="nx">data1</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">buffer</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="kd">let</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">};</span>

<span class="nx">wsClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_initWs</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">biboxws</span><span class="p">)</span>
    <span class="kd">let</span> <span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebSocket</span><span class="p">(</span><span class="nx">biboxws</span><span class="p">);</span>
    <span class="nx">that</span><span class="p">.</span><span class="nx">ws</span> <span class="o">=</span> <span class="nx">ws</span><span class="p">;</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">open</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">)</span>
        <span class="p">{</span><span class="c1">// kline</span>
            <span class="nx">ws</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
                <span class="na">event</span><span class="p">:</span> <span class="dl">'</span><span class="s1">addChannel</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">sub</span><span class="p">:</span> <span class="dl">'</span><span class="s1">4BTC_USDT_depth</span><span class="dl">'</span><span class="p">,</span>
            <span class="p">}));</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">close</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">close, </span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping </span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong </span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">_decodeMsg</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">0</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">)));</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="nx">data</span><span class="p">);</span>
        <span class="p">}</span>

    <span class="p">});</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">wsClass</span><span class="p">();</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">_initWs</span><span class="p">().</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># /usr/bin/env python
# -*- coding: UTF-8 -*-
</span>
<span class="kn">import</span> <span class="nn">websocket</span> <span class="c1"># websocket-client
</span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">zlib</span>

<span class="n">ws_url</span> <span class="o">=</span> <span class="s">'wss://push.trade-planets.com/cbu'</span>


<span class="k">def</span> <span class="nf">stringify</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">"</span><span class="se">\'</span><span class="s">"</span><span class="p">,</span> <span class="s">"</span><span class="se">\"</span><span class="s">"</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">" "</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_sub_str</span><span class="p">():</span>
    <span class="n">subdata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'sub'</span><span class="p">:</span> <span class="s">'4BTC_USDT_depth'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="c1"># print(stringify(subdata))
</span>    <span class="k">return</span> <span class="n">stringify</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_unsub_str</span><span class="p">():</span>
    <span class="n">subdata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'unsub'</span><span class="p">:</span> <span class="s">'4BTC_USDT_depth'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">stringify</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">decode_data</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">'</span><span class="se">\x01</span><span class="s">'</span> <span class="ow">or</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">zlib</span><span class="p">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">zlib</span><span class="p">.</span><span class="n">MAX_WBITS</span> <span class="o">|</span> <span class="mi">32</span><span class="p">)</span>
        <span class="n">jmsgs</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">'</span><span class="se">\x00</span><span class="s">'</span> <span class="ow">or</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">jmsgs</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">jmsgs</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="c1"># print(message)
</span>    <span class="n">decode_data</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_error</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"### closed ###"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_open</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">get_sub_str</span><span class="p">())</span>


<span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
    <span class="n">websocket</span><span class="p">.</span><span class="n">enableTrace</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ws</span> <span class="o">=</span> <span class="n">websocket</span><span class="p">.</span><span class="n">WebSocketApp</span><span class="p">(</span><span class="n">ws_url</span><span class="p">,</span>
                                <span class="n">on_message</span><span class="o">=</span><span class="n">on_message</span><span class="p">,</span>
                                <span class="n">on_error</span><span class="o">=</span><span class="n">on_error</span><span class="p">,</span>
                                <span class="n">on_close</span><span class="o">=</span><span class="n">on_close</span><span class="p">)</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">on_open</span> <span class="o">=</span> <span class="n">on_open</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">run_forever</span><span class="p">(</span><span class="n">ping_interval</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ping_timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">connect</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">WebSocketSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO.Compression</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Example</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

  <span class="k">public</span> <span class="k">class</span> <span class="nc">Program</span>
  <span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">Decompress</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">bytes</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">MemoryStream</span> <span class="n">msIn</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">bytes</span><span class="p">.</span><span class="n">Length</span> <span class="p">-</span> <span class="m">1</span><span class="p">);</span>
        <span class="n">MemoryStream</span> <span class="n">msOut</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">();</span>

        <span class="n">GZipStream</span> <span class="n">cprs</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GZipStream</span><span class="p">(</span><span class="n">msIn</span><span class="p">,</span> <span class="n">CompressionMode</span><span class="p">.</span><span class="n">Decompress</span><span class="p">);</span>
        <span class="n">cprs</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="n">msOut</span><span class="p">);</span>
        <span class="n">cprs</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>

        <span class="k">return</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetString</span><span class="p">(</span><span class="n">msOut</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">());</span><span class="c1">//转换为普通的字符串</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="kt">string</span> <span class="n">wsuri</span> <span class="p">=</span> <span class="s">"wss://push.trade-planets.com/cbu"</span><span class="p">;</span>
      <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">ws</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WebSocket</span> <span class="p">(</span><span class="n">wsuri</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">ws</span><span class="p">.</span><span class="n">OnMessage</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>

            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"recv: "</span> <span class="p">+</span> <span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">IsText</span><span class="p">)</span> <span class="p">{</span>
              <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"data[0]: {"</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">IsBinary</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"RawData[0]: 1"</span><span class="p">);</span>
                    <span class="kt">string</span> <span class="n">strres</span> <span class="p">=</span> <span class="nf">Decompress</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="n">strres</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"RawData[0]: 0"</span><span class="p">);</span>
                    <span class="kt">string</span> <span class="n">strres</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetString</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="n">strres</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>

        <span class="p">};</span>

        <span class="n">ws</span><span class="p">.</span><span class="nf">Connect</span> <span class="p">();</span>

        <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
            <span class="n">sub</span> <span class="p">=</span> <span class="s">"4BTC_USDT_depth"</span><span class="p">,</span>
        <span class="p">};</span>

        <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

        <span class="n">ws</span><span class="p">.</span><span class="nf">Send</span> <span class="p">(</span><span class="n">payload</span><span class="p">);</span>

        <span class="n">ConsoleKey</span> <span class="n">key</span><span class="p">;</span>
        <span class="k">do</span>
    <span class="err">　　</span><span class="p">{</span>
    <span class="err">　　</span>      <span class="n">key</span><span class="p">=</span><span class="n">Console</span><span class="p">.</span><span class="nf">ReadKey</span><span class="p">().</span><span class="n">Key</span><span class="p">;</span>
    <span class="err">　　</span>
    <span class="err">　　</span><span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">key</span> <span class="p">!=</span> <span class="n">ConsoleKey</span><span class="p">.</span><span class="n">Q</span><span class="p">);</span>

      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Subscription path</li>
</ul>

<p>wss://push.trade-planets.com/cbu</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>true</td>
<td>string</td>
<td>pair</td>
<td></td>
<td>4BTC_USDT, 4ETH_USDT</td>
</tr>
<tr>
<td>sub</td>
<td>true</td>
<td>string</td>
<td></td>
<td></td>
<td>${pair} + &#39;_depth&#39;</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"topic"</span><span class="p">:</span><span class="s2">"4BTC_USDT_depth"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"d"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"pair"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"ut"</span><span class="p">:</span><span class="mi">1639124171584</span><span class="p">,</span><span class="w">
        </span><span class="nl">"seq"</span><span class="p">:</span><span class="mi">188236</span><span class="p">,</span><span class="w">
        </span><span class="nl">"asks"</span><span class="p">:[</span><span class="w">
            </span><span class="p">[</span><span class="w">
                </span><span class="s2">"7.904"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"47741.6"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="p">[</span><span class="w">
                </span><span class="s2">"0.604"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"47741.8"</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">],</span><span class="w">
        </span><span class="nl">"bids"</span><span class="p">:[</span><span class="w">
            </span><span class="p">[</span><span class="w">
                </span><span class="s2">"1.667"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"47741.3"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="p">[</span><span class="w">
                </span><span class="s2">"0.534"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"47726.8"</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="p">{</span><span class="w">
    </span><span class="nl">"topic"</span><span class="p">:</span><span class="s2">"4BTC_USDT_depth"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"d"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"pair"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"ut"</span><span class="p">:</span><span class="mi">1639124172771</span><span class="p">,</span><span class="w">
        </span><span class="nl">"seq"</span><span class="p">:</span><span class="mi">188240</span><span class="p">,</span><span class="w">
        </span><span class="nl">"add"</span><span class="p">:{</span><span class="w">
            </span><span class="nl">"asks"</span><span class="p">:[</span><span class="w">
                </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"0.11"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"47744.9"</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"bids"</span><span class="p">:[</span><span class="w">
                </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"0.809"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"47741.5"</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"del"</span><span class="p">:{</span><span class="w">
            </span><span class="nl">"asks"</span><span class="p">:</span><span class="kc">null</span><span class="p">,</span><span class="w">
            </span><span class="nl">"bids"</span><span class="p">:[</span><span class="w">
                </span><span class="p">[</span><span class="w">
                    </span><span class="s2">"0.522"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"47741.3"</span><span class="w">
                </span><span class="p">]</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>pair</td>
</tr>
<tr>
<td>update_time</td>
<td>time</td>
</tr>
<tr>
<td>seq</td>
<td>pair</td>
</tr>
<tr>
<td>add</td>
<td>add data</td>
</tr>
<tr>
<td>del</td>
<td>delete data</td>
</tr>
<tr>
<td>mod</td>
<td>modify data</td>
</tr>
<tr>
<td>asks</td>
<td>ask data</td>
</tr>
<tr>
<td>bids</td>
<td>bid data</td>
</tr>
<tr>
<td>volume</td>
<td>Order quantity</td>
</tr>
<tr>
<td>price</td>
<td>price</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='33-subscription-to-deals-detail'>33.Subscription to deals detail</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code>
<span class="kd">const</span> <span class="nx">WebSocket</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">ws</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">zlib</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">zlib</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">biboxws</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">wss://push.trade-planets.com/cbu</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">wsClass</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

<span class="p">};</span>

<span class="nx">wsClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_decodeMsg</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">data1</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
    <span class="nx">zlib</span><span class="p">.</span><span class="nx">unzip</span><span class="p">(</span><span class="nx">data1</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">buffer</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="kd">let</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">};</span>

<span class="nx">wsClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_initWs</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">biboxws</span><span class="p">)</span>
    <span class="kd">let</span> <span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebSocket</span><span class="p">(</span><span class="nx">biboxws</span><span class="p">);</span>
    <span class="nx">that</span><span class="p">.</span><span class="nx">ws</span> <span class="o">=</span> <span class="nx">ws</span><span class="p">;</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">open</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">)</span>
        <span class="p">{</span><span class="c1">// kline</span>
            <span class="nx">ws</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
                <span class="na">event</span><span class="p">:</span> <span class="dl">'</span><span class="s1">addChannel</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">sub</span><span class="p">:</span> <span class="dl">'</span><span class="s1">4BTC_USDT_deals</span><span class="dl">'</span><span class="p">,</span>
            <span class="p">}));</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">close</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">close, </span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping </span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong </span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">_decodeMsg</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">0</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">)));</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="nx">data</span><span class="p">);</span>
        <span class="p">}</span>

    <span class="p">});</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">wsClass</span><span class="p">();</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">_initWs</span><span class="p">().</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># /usr/bin/env python
# -*- coding: UTF-8 -*-
</span>
<span class="kn">import</span> <span class="nn">websocket</span> <span class="c1"># websocket-client
</span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">zlib</span>

<span class="n">ws_url</span> <span class="o">=</span> <span class="s">'wss://push.trade-planets.com/cbu'</span>


<span class="k">def</span> <span class="nf">stringify</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">"</span><span class="se">\'</span><span class="s">"</span><span class="p">,</span> <span class="s">"</span><span class="se">\"</span><span class="s">"</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">" "</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_sub_str</span><span class="p">():</span>
    <span class="n">subdata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'sub'</span><span class="p">:</span> <span class="s">'4BTC_USDT_deals'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="c1"># print(stringify(subdata))
</span>    <span class="k">return</span> <span class="n">stringify</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_unsub_str</span><span class="p">():</span>
    <span class="n">subdata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'unsub'</span><span class="p">:</span> <span class="s">'4BTC_USDT_deals'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">stringify</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">decode_data</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">'</span><span class="se">\x01</span><span class="s">'</span> <span class="ow">or</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">zlib</span><span class="p">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">zlib</span><span class="p">.</span><span class="n">MAX_WBITS</span> <span class="o">|</span> <span class="mi">32</span><span class="p">)</span>
        <span class="n">jmsgs</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">'</span><span class="se">\x00</span><span class="s">'</span> <span class="ow">or</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">jmsgs</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">jmsgs</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="c1"># print(message)
</span>    <span class="n">decode_data</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_error</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"### closed ###"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_open</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">get_sub_str</span><span class="p">())</span>


<span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
    <span class="n">websocket</span><span class="p">.</span><span class="n">enableTrace</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ws</span> <span class="o">=</span> <span class="n">websocket</span><span class="p">.</span><span class="n">WebSocketApp</span><span class="p">(</span><span class="n">ws_url</span><span class="p">,</span>
                                <span class="n">on_message</span><span class="o">=</span><span class="n">on_message</span><span class="p">,</span>
                                <span class="n">on_error</span><span class="o">=</span><span class="n">on_error</span><span class="p">,</span>
                                <span class="n">on_close</span><span class="o">=</span><span class="n">on_close</span><span class="p">)</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">on_open</span> <span class="o">=</span> <span class="n">on_open</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">run_forever</span><span class="p">(</span><span class="n">ping_interval</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ping_timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">connect</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">WebSocketSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO.Compression</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Example</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

  <span class="k">public</span> <span class="k">class</span> <span class="nc">Program</span>
  <span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">Decompress</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">bytes</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">MemoryStream</span> <span class="n">msIn</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">bytes</span><span class="p">.</span><span class="n">Length</span> <span class="p">-</span> <span class="m">1</span><span class="p">);</span>
        <span class="n">MemoryStream</span> <span class="n">msOut</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">();</span>

        <span class="n">GZipStream</span> <span class="n">cprs</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GZipStream</span><span class="p">(</span><span class="n">msIn</span><span class="p">,</span> <span class="n">CompressionMode</span><span class="p">.</span><span class="n">Decompress</span><span class="p">);</span>
        <span class="n">cprs</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="n">msOut</span><span class="p">);</span>
        <span class="n">cprs</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>

        <span class="k">return</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetString</span><span class="p">(</span><span class="n">msOut</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">());</span><span class="c1">//转换为普通的字符串</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="kt">string</span> <span class="n">wsuri</span> <span class="p">=</span> <span class="s">"wss://push.trade-planets.com/cbu"</span><span class="p">;</span>
      <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">ws</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WebSocket</span> <span class="p">(</span><span class="n">wsuri</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">ws</span><span class="p">.</span><span class="n">OnMessage</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>

            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"recv: "</span> <span class="p">+</span> <span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">IsText</span><span class="p">)</span> <span class="p">{</span>
              <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"data[0]: {"</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">IsBinary</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"RawData[0]: 1"</span><span class="p">);</span>
                    <span class="kt">string</span> <span class="n">strres</span> <span class="p">=</span> <span class="nf">Decompress</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="n">strres</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"RawData[0]: 0"</span><span class="p">);</span>
                    <span class="kt">string</span> <span class="n">strres</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetString</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="n">strres</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>

        <span class="p">};</span>

        <span class="n">ws</span><span class="p">.</span><span class="nf">Connect</span> <span class="p">();</span>

        <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
            <span class="n">sub</span> <span class="p">=</span> <span class="s">"4BTC_USDT_deals"</span><span class="p">,</span>
        <span class="p">};</span>

        <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

        <span class="n">ws</span><span class="p">.</span><span class="nf">Send</span> <span class="p">(</span><span class="n">payload</span><span class="p">);</span>

        <span class="n">ConsoleKey</span> <span class="n">key</span><span class="p">;</span>
        <span class="k">do</span>
    <span class="err">　　</span><span class="p">{</span>
    <span class="err">　　</span>      <span class="n">key</span><span class="p">=</span><span class="n">Console</span><span class="p">.</span><span class="nf">ReadKey</span><span class="p">().</span><span class="n">Key</span><span class="p">;</span>
    <span class="err">　　</span>
    <span class="err">　　</span><span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">key</span> <span class="p">!=</span> <span class="n">ConsoleKey</span><span class="p">.</span><span class="n">Q</span><span class="p">);</span>

      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Subscription path</li>
</ul>

<p>wss://push.trade-planets.com/cbu</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>true</td>
<td>string</td>
<td>pair</td>
<td></td>
<td>4BTC_USDT, 4ETH_USDT</td>
</tr>
<tr>
<td>sub</td>
<td>true</td>
<td>string</td>
<td></td>
<td></td>
<td>&#39;${pair} + &#39;_deals&#39;</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"topic"</span><span class="p">:</span><span class="s2">"4BTC_USDT_deals"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"d"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"pair"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"d"</span><span class="p">:[</span><span class="w">
            </span><span class="p">[</span><span class="w">
                </span><span class="s2">"48008.1"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"0.009"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"1639124930499"</span><span class="p">,</span><span class="w">
                </span><span class="s2">""</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="p">[</span><span class="w">
                </span><span class="s2">"48006.5"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"0.021"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"1639124930328"</span><span class="p">,</span><span class="w">
                </span><span class="s2">""</span><span class="w">
            </span><span class="p">]</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="p">{</span><span class="w">
  </span><span class="err">topic:</span><span class="w"> </span><span class="err">'</span><span class="mi">4</span><span class="err">BTC_USDT_deals'</span><span class="p">,</span><span class="w">
  </span><span class="err">t:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
  </span><span class="err">d:</span><span class="w"> </span><span class="p">[</span><span class="w">
         </span><span class="s2">"48008.1"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"0.009"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
         </span><span class="s2">"1639124930499"</span><span class="p">,</span><span class="w">
         </span><span class="s2">""</span><span class="w">
     </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<p>[
Deal price,
Deal amount,
trade side(1 buy, 2 sell),
Timestamp
]</p>
<h2 id='34-subscription-to-ticker'>34.Subscription to ticker</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code>
<span class="kd">const</span> <span class="nx">WebSocket</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">ws</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">zlib</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">zlib</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">biboxws</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">wss://push.trade-planets.com/cbu</span><span class="dl">'</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">wsClass</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>

<span class="p">};</span>

<span class="nx">wsClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_decodeMsg</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">data1</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
    <span class="nx">zlib</span><span class="p">.</span><span class="nx">unzip</span><span class="p">(</span><span class="nx">data1</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">buffer</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="kd">let</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">};</span>

<span class="nx">wsClass</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">_initWs</span> <span class="o">=</span> <span class="k">async</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">that</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">biboxws</span><span class="p">)</span>
    <span class="kd">let</span> <span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebSocket</span><span class="p">(</span><span class="nx">biboxws</span><span class="p">);</span>
    <span class="nx">that</span><span class="p">.</span><span class="nx">ws</span> <span class="o">=</span> <span class="nx">ws</span><span class="p">;</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">open</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">)</span>
        <span class="p">{</span><span class="c1">// kline</span>
            <span class="nx">ws</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
                <span class="na">event</span><span class="p">:</span> <span class="dl">'</span><span class="s1">addChannel</span><span class="dl">'</span><span class="p">,</span>
                <span class="na">sub</span><span class="p">:</span> <span class="dl">'</span><span class="s1">4BTC_USDT_ticker</span><span class="dl">'</span><span class="p">,</span>
            <span class="p">}));</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">close</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">close, </span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping </span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong </span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="nx">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">that</span><span class="p">.</span><span class="nx">_decodeMsg</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">0</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">)));</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span> <span class="nx">data</span><span class="p">);</span>
        <span class="p">}</span>

    <span class="p">});</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">wsClass</span><span class="p">();</span>

<span class="nx">instance</span><span class="p">.</span><span class="nx">_initWs</span><span class="p">().</span><span class="k">catch</span><span class="p">(</span><span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
<span class="p">});</span>

</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># /usr/bin/env python
# -*- coding: UTF-8 -*-
</span>
<span class="kn">import</span> <span class="nn">websocket</span> <span class="c1"># websocket-client
</span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">zlib</span>

<span class="n">ws_url</span> <span class="o">=</span> <span class="s">'wss://push.trade-planets.com/cbu'</span>


<span class="k">def</span> <span class="nf">stringify</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">"</span><span class="se">\'</span><span class="s">"</span><span class="p">,</span> <span class="s">"</span><span class="se">\"</span><span class="s">"</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">" "</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_sub_str</span><span class="p">():</span>
    <span class="n">subdata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'sub'</span><span class="p">:</span> <span class="s">'4BTC_USDT_ticker'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="c1"># print(stringify(subdata))
</span>    <span class="k">return</span> <span class="n">stringify</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_unsub_str</span><span class="p">():</span>
    <span class="n">subdata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'unsub'</span><span class="p">:</span> <span class="s">'4BTC_USDT_ticker'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">stringify</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">decode_data</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">'</span><span class="se">\x01</span><span class="s">'</span> <span class="ow">or</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">zlib</span><span class="p">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">zlib</span><span class="p">.</span><span class="n">MAX_WBITS</span> <span class="o">|</span> <span class="mi">32</span><span class="p">)</span>
        <span class="n">jmsgs</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">'</span><span class="se">\x00</span><span class="s">'</span> <span class="ow">or</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">jmsgs</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">jmsgs</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="c1"># print(message)
</span>    <span class="n">decode_data</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_error</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"### closed ###"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_open</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">get_sub_str</span><span class="p">())</span>


<span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
    <span class="n">websocket</span><span class="p">.</span><span class="n">enableTrace</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ws</span> <span class="o">=</span> <span class="n">websocket</span><span class="p">.</span><span class="n">WebSocketApp</span><span class="p">(</span><span class="n">ws_url</span><span class="p">,</span>
                                <span class="n">on_message</span><span class="o">=</span><span class="n">on_message</span><span class="p">,</span>
                                <span class="n">on_error</span><span class="o">=</span><span class="n">on_error</span><span class="p">,</span>
                                <span class="n">on_close</span><span class="o">=</span><span class="n">on_close</span><span class="p">)</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">on_open</span> <span class="o">=</span> <span class="n">on_open</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">run_forever</span><span class="p">(</span><span class="n">ping_interval</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ping_timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">connect</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">WebSocketSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO.Compression</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Example</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

  <span class="k">public</span> <span class="k">class</span> <span class="nc">Program</span>
  <span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">Decompress</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">bytes</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">MemoryStream</span> <span class="n">msIn</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">bytes</span><span class="p">.</span><span class="n">Length</span> <span class="p">-</span> <span class="m">1</span><span class="p">);</span>
        <span class="n">MemoryStream</span> <span class="n">msOut</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">();</span>

        <span class="n">GZipStream</span> <span class="n">cprs</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GZipStream</span><span class="p">(</span><span class="n">msIn</span><span class="p">,</span> <span class="n">CompressionMode</span><span class="p">.</span><span class="n">Decompress</span><span class="p">);</span>
        <span class="n">cprs</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="n">msOut</span><span class="p">);</span>
        <span class="n">cprs</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>

        <span class="k">return</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetString</span><span class="p">(</span><span class="n">msOut</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">());</span><span class="c1">//转换为普通的字符串</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
      <span class="kt">string</span> <span class="n">wsuri</span> <span class="p">=</span> <span class="s">"wss://push.trade-planets.com/cbu"</span><span class="p">;</span>
      <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">ws</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WebSocket</span> <span class="p">(</span><span class="n">wsuri</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">ws</span><span class="p">.</span><span class="n">OnMessage</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>

            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"recv: "</span> <span class="p">+</span> <span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">IsText</span><span class="p">)</span> <span class="p">{</span>
              <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"data[0]: {"</span><span class="p">);</span>
            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">IsBinary</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"RawData[0]: 1"</span><span class="p">);</span>
                    <span class="kt">string</span> <span class="n">strres</span> <span class="p">=</span> <span class="nf">Decompress</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="n">strres</span><span class="p">);</span>
                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"RawData[0]: 0"</span><span class="p">);</span>
                    <span class="kt">string</span> <span class="n">strres</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetString</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="n">strres</span><span class="p">);</span>
                <span class="p">}</span>
            <span class="p">}</span>

        <span class="p">};</span>

        <span class="n">ws</span><span class="p">.</span><span class="nf">Connect</span> <span class="p">();</span>

        <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
            <span class="n">sub</span> <span class="p">=</span> <span class="s">"4BTC_USDT_ticker"</span><span class="p">,</span>
        <span class="p">};</span>

        <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

        <span class="n">ws</span><span class="p">.</span><span class="nf">Send</span> <span class="p">(</span><span class="n">payload</span><span class="p">);</span>

        <span class="n">ConsoleKey</span> <span class="n">key</span><span class="p">;</span>
        <span class="k">do</span>
    <span class="err">　　</span><span class="p">{</span>
    <span class="err">　　</span>      <span class="n">key</span><span class="p">=</span><span class="n">Console</span><span class="p">.</span><span class="nf">ReadKey</span><span class="p">().</span><span class="n">Key</span><span class="p">;</span>
    <span class="err">　　</span>
    <span class="err">　　</span><span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">key</span> <span class="p">!=</span> <span class="n">ConsoleKey</span><span class="p">.</span><span class="n">Q</span><span class="p">);</span>

      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Subscription path</li>
</ul>

<p>wss://push.trade-planets.com/cbu</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>pair</td>
<td>true</td>
<td>string</td>
<td>pair</td>
<td></td>
<td>4BTC_USDT, 4ETH_USDT</td>
</tr>
<tr>
<td>sub</td>
<td>true</td>
<td>string</td>
<td></td>
<td></td>
<td>${pair} + &#39;_ticker&#39;</td>
</tr>
</tbody></table>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"topic"</span><span class="p">:</span><span class="s2">"4BTC_USDT_ticker"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"d"</span><span class="p">:[</span><span class="w">
        </span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"48099.9"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"48099.90"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"299951.30"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"49631.3"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"47319.1"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"48095.1"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"0.041"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"48098.1"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"2.292"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"16781.668"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"-2.83%"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"1639125637999"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"299951.30000000"</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>3.Response field description</li>
</ul>

<p>[
pair,
last price,
last cny price,
last usd price,
24hHighest price,
24hLowest price,
Latest bid price,
Latest bid amount,
Latest ask price,
Latest ask amount,
24hDeal amount,
24h Quote change,
Timestamp,
Latest cny price
]</p>
<h2 id='35-subscription-to-user-data'>35.Subscription to user data</h2>
<blockquote>
<p>Example</p>
</blockquote>
<div class="highlight"><pre class="highlight javascript tab-javascript"><code>
<span class="dl">'</span><span class="s1">use strict</span><span class="dl">'</span>

<span class="kd">const</span> <span class="nx">WebSocket</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">ws</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">zlib</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">zlib</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">CryptoJS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">"</span><span class="s2">crypto-js</span><span class="dl">"</span><span class="p">);</span>

<span class="kd">const</span> <span class="nx">biboxws</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">wss://push.trade-planets.com/cbu</span><span class="dl">'</span><span class="p">;</span> <span class="c1">//  1.Request path</span>

<span class="kd">let</span> <span class="nx">ws</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">900625568558820892a8c833c33ebc8fd2701efe</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// your apikey</span>
<span class="kd">let</span> <span class="nx">secret</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">c708ac3e70d115ec29efbee197330627d7edf842</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// apikey的密码</span>

<span class="kd">let</span> <span class="nx">subparam</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span> <span class="c1">// .Format the parameter object, get subparam</span>
    <span class="nx">apikey</span><span class="p">,</span>
    <span class="na">sub</span><span class="p">:</span> <span class="dl">'</span><span class="s1">ALL_ALL_login</span><span class="dl">'</span>
<span class="p">});</span>
<span class="kd">let</span> <span class="nx">sign</span> <span class="o">=</span> <span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">HmacMD5</span><span class="p">(</span><span class="nx">subparam</span><span class="p">,</span> <span class="nb">String</span><span class="p">(</span><span class="nx">secret</span><span class="p">)).</span><span class="nx">toString</span><span class="p">();</span> <span class="c1">// Use apikey's secret to sign subparam with HmacMD5, and get the signature result sign</span>
<span class="kd">let</span> <span class="nx">form</span> <span class="o">=</span> <span class="p">{</span> <span class="c1">// 2.Request parameter</span>
    <span class="nx">apikey</span><span class="p">,</span>
    <span class="nx">sign</span><span class="p">,</span>
    <span class="na">sub</span><span class="p">:</span> <span class="dl">'</span><span class="s1">ALL_ALL_login</span><span class="dl">'</span><span class="p">,</span>
<span class="p">};</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">form</span><span class="dl">'</span><span class="p">,</span> <span class="nx">form</span><span class="p">)</span>

<span class="kd">let</span> <span class="nx">reiniting</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">resend</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">user_id</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">ws</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">!=</span> <span class="nx">WebSocket</span><span class="p">.</span><span class="nx">OPEN</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">resend</span><span class="p">(</span><span class="nx">user_id</span><span class="p">);</span>
        <span class="p">},</span> <span class="mi">1000</span> <span class="o">*</span> <span class="mi">10</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">form</span><span class="p">));</span>
<span class="p">};</span>

<span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">ws</span> <span class="o">&amp;&amp;</span> <span class="nx">ws</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">==</span> <span class="nx">WebSocket</span><span class="p">.</span><span class="nx">OPEN</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">ws</span><span class="p">.</span><span class="nx">ping</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">().</span><span class="nx">getTime</span><span class="p">());</span>
    <span class="p">}</span>
<span class="p">},</span> <span class="mi">1000</span> <span class="o">*</span> <span class="mi">10</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">reinit</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">reiniting</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">reiniting</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">try</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">ws</span> <span class="o">&amp;&amp;</span> <span class="nx">ws</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">==</span> <span class="nx">WebSocket</span><span class="p">.</span><span class="nx">OPEN</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">manu close </span><span class="dl">'</span><span class="p">)</span>
            <span class="nx">ws</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>

    <span class="p">}</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">init</span><span class="p">();</span>
    <span class="p">},</span> <span class="mi">1000</span> <span class="o">*</span> <span class="mi">30</span><span class="p">);</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">init</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">user_id</span><span class="p">)</span> <span class="p">{</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">init</span><span class="dl">'</span><span class="p">,</span> <span class="nx">user_id</span><span class="p">);</span>
    <span class="nx">reiniting</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>

    <span class="nx">ws</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">WebSocket</span><span class="p">(</span><span class="nx">biboxws</span><span class="p">);</span>

    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">ws</span> <span class="o">||</span> <span class="nx">ws</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">!=</span> <span class="nx">WebSocket</span><span class="p">.</span><span class="nx">OPEN</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">reinit</span><span class="p">(</span><span class="nx">user_id</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span> <span class="mi">1000</span> <span class="o">*</span> <span class="mi">60</span><span class="p">);</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">open</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">open</span><span class="p">()</span> <span class="p">{</span>

        <span class="nx">resend</span><span class="p">(</span><span class="nx">user_id</span><span class="p">);</span>

    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">close</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">close, </span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="nx">reinit</span><span class="p">(</span><span class="nx">user_id</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">error</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="nx">reinit</span><span class="p">(</span><span class="nx">user_id</span><span class="p">);</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">ping on</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="dl">'</span><span class="s1">utf8</span><span class="dl">'</span><span class="p">));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">pong</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="c1">// console.log('pong ', err.toString('utf8'));</span>
    <span class="p">});</span>

    <span class="nx">ws</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="dl">'</span><span class="s1">message</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="nx">incoming</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="dl">'</span><span class="s1">1</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">decodeMsg</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">data</span><span class="p">));</span>
        <span class="p">}</span>

    <span class="p">});</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">login</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">reiniting</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">reiniting</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
    <span class="nx">init</span><span class="p">();</span>
<span class="p">};</span>

<span class="kd">let</span> <span class="nx">decodeMsg</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">let</span> <span class="nx">data1</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
    <span class="nx">zlib</span><span class="p">.</span><span class="nx">unzip</span><span class="p">(</span><span class="nx">data1</span><span class="p">,</span> <span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">buffer</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">2</span><span class="dl">'</span><span class="p">,</span> <span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">try</span> <span class="p">{</span>
                <span class="kd">let</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">buffer</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">3</span><span class="dl">'</span><span class="p">,</span> <span class="nx">buffer</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span>
            <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">4</span><span class="dl">'</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">};</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{};</span>

<span class="nx">login</span><span class="p">();</span>


</code></pre></div><div class="highlight"><pre class="highlight python tab-python"><code><span class="c1"># /usr/bin/env python
# -*- coding: UTF-8 -*-
</span>
<span class="kn">import</span> <span class="nn">websocket</span> <span class="c1"># websocket-client
</span><span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">zlib</span>
<span class="kn">import</span> <span class="nn">hmac</span>
<span class="kn">import</span> <span class="nn">hashlib</span>

<span class="n">ws_url</span> <span class="o">=</span> <span class="s">'wss://push.trade-planets.com/cbu'</span>
<span class="n">apikey</span> <span class="o">=</span> <span class="s">'900625568558820892a8c833c33ebc8fd2701efe'</span>  <span class="c1"># your apikey
</span><span class="n">secret</span> <span class="o">=</span> <span class="s">'c708ac3e70d115ec29efbee197330627d7edf842'</span>  <span class="c1"># your apikey secret
</span>

<span class="k">def</span> <span class="nf">stringify</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">json</span><span class="p">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="bp">True</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">"</span><span class="se">\'</span><span class="s">"</span><span class="p">,</span> <span class="s">"</span><span class="se">\"</span><span class="s">"</span><span class="p">).</span><span class="n">replace</span><span class="p">(</span><span class="s">" "</span><span class="p">,</span> <span class="s">""</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_sign</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">secret</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">hmac</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="n">secret</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">data</span><span class="p">.</span><span class="n">encode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">),</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">md5</span><span class="p">).</span><span class="n">hexdigest</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">get_sub_str</span><span class="p">():</span>
    <span class="n">subdata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'apikey'</span><span class="p">:</span> <span class="n">apikey</span><span class="p">,</span>
        <span class="s">'sub'</span><span class="p">:</span> <span class="s">'ALL_ALL_login'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="c1"># print(stringify(subdata))
</span>    <span class="n">sign</span> <span class="o">=</span> <span class="n">get_sign</span><span class="p">(</span><span class="n">stringify</span><span class="p">(</span><span class="n">subdata</span><span class="p">),</span> <span class="n">secret</span><span class="p">)</span>
    <span class="n">subdata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'apikey'</span><span class="p">:</span> <span class="n">apikey</span><span class="p">,</span>
        <span class="s">'sign'</span><span class="p">:</span> <span class="n">sign</span><span class="p">,</span>
        <span class="s">'sub'</span><span class="p">:</span> <span class="s">'ALL_ALL_login'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="c1"># print(stringify(subdata))
</span>    <span class="k">return</span> <span class="n">stringify</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">get_unsub_str</span><span class="p">():</span>
    <span class="n">subdata</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'unsub'</span><span class="p">:</span> <span class="s">'ALL_ALL_login'</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">stringify</span><span class="p">(</span><span class="n">subdata</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">decode_data</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s">'</span><span class="se">\x01</span><span class="s">'</span> <span class="ow">or</span> <span class="n">message</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="n">message</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">zlib</span><span class="p">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">zlib</span><span class="p">.</span><span class="n">MAX_WBITS</span> <span class="o">|</span> <span class="mi">32</span><span class="p">)</span>
        <span class="n">jmsgs</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">jmsgs</span> <span class="o">=</span> <span class="n">json</span><span class="p">.</span><span class="n">loads</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">jmsgs</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">on_message</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">message</span><span class="p">):</span>
    <span class="c1"># print(message)
</span>    <span class="n">decode_data</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_error</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_close</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"### closed ###"</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">on_open</span><span class="p">(</span><span class="n">ws</span><span class="p">):</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">send</span><span class="p">(</span><span class="n">get_sub_str</span><span class="p">())</span>


<span class="k">def</span> <span class="nf">connect</span><span class="p">():</span>
    <span class="n">websocket</span><span class="p">.</span><span class="n">enableTrace</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">ws</span> <span class="o">=</span> <span class="n">websocket</span><span class="p">.</span><span class="n">WebSocketApp</span><span class="p">(</span><span class="n">ws_url</span><span class="p">,</span>
                                <span class="n">on_message</span><span class="o">=</span><span class="n">on_message</span><span class="p">,</span>
                                <span class="n">on_error</span><span class="o">=</span><span class="n">on_error</span><span class="p">,</span>
                                <span class="n">on_close</span><span class="o">=</span><span class="n">on_close</span><span class="p">)</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">on_open</span> <span class="o">=</span> <span class="n">on_open</span>
    <span class="n">ws</span><span class="p">.</span><span class="n">run_forever</span><span class="p">(</span><span class="n">ping_interval</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ping_timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">connect</span><span class="p">()</span>

</code></pre></div><div class="highlight"><pre class="highlight csharp tab-csharp"><code><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">WebSocketSharp</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Net.Http</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO.Compression</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Security.Cryptography</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">Newtonsoft.Json.Serialization</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Example</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">SortContractResolver</span> <span class="p">:</span> <span class="n">DefaultContractResolver</span>
    <span class="p">{</span>
        <span class="k">protected</span> <span class="k">override</span> <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="nf">CreateProperties</span><span class="p">(</span><span class="n">Type</span> <span class="n">type</span><span class="p">,</span> <span class="n">MemberSerialization</span> <span class="n">memberSerialization</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">IList</span><span class="p">&lt;</span><span class="n">JsonProperty</span><span class="p">&gt;</span> <span class="n">properties</span> <span class="p">=</span> <span class="k">base</span><span class="p">.</span><span class="nf">CreateProperties</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">memberSerialization</span><span class="p">);</span>

            <span class="k">return</span> <span class="n">properties</span><span class="p">.</span><span class="nf">OrderBy</span><span class="p">(</span><span class="n">x</span><span class="p">=&gt;</span><span class="n">x</span><span class="p">.</span><span class="n">PropertyName</span><span class="p">).</span><span class="nf">ToList</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>

  <span class="k">public</span> <span class="k">class</span> <span class="nc">Program</span>
  <span class="p">{</span>

    <span class="k">public</span> <span class="k">static</span> <span class="kt">string</span> <span class="nf">Decompress</span><span class="p">(</span><span class="kt">byte</span><span class="p">[]</span> <span class="n">bytes</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">MemoryStream</span> <span class="n">msIn</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="n">bytes</span><span class="p">.</span><span class="n">Length</span> <span class="p">-</span> <span class="m">1</span><span class="p">);</span>
        <span class="n">MemoryStream</span> <span class="n">msOut</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">MemoryStream</span><span class="p">();</span>

        <span class="n">GZipStream</span> <span class="n">cprs</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">GZipStream</span><span class="p">(</span><span class="n">msIn</span><span class="p">,</span> <span class="n">CompressionMode</span><span class="p">.</span><span class="n">Decompress</span><span class="p">);</span>
        <span class="n">cprs</span><span class="p">.</span><span class="nf">CopyTo</span><span class="p">(</span><span class="n">msOut</span><span class="p">);</span>
        <span class="n">cprs</span><span class="p">.</span><span class="nf">Close</span><span class="p">();</span>

        <span class="k">return</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetString</span><span class="p">(</span><span class="n">msOut</span><span class="p">.</span><span class="nf">ToArray</span><span class="p">());</span><span class="c1">//转换为普通的字符串</span>
    <span class="p">}</span>

    <span class="k">static</span> <span class="kt">string</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="kt">string</span> <span class="n">source</span><span class="p">,</span> <span class="kt">string</span> <span class="n">key</span><span class="p">)</span>
           <span class="p">{</span>
               <span class="n">HMACMD5</span> <span class="n">hmacmd</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">HMACMD5</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">key</span><span class="p">));</span>
               <span class="kt">byte</span><span class="p">[]</span> <span class="n">inArray</span> <span class="p">=</span> <span class="n">hmacmd</span><span class="p">.</span><span class="nf">ComputeHash</span><span class="p">(</span><span class="n">Encoding</span><span class="p">.</span><span class="n">Default</span><span class="p">.</span><span class="nf">GetBytes</span><span class="p">(</span><span class="n">source</span><span class="p">));</span>
               <span class="n">StringBuilder</span> <span class="n">sb</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="p">();</span>

               <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">inArray</span><span class="p">.</span><span class="n">Length</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
               <span class="p">{</span>
                   <span class="n">sb</span><span class="p">.</span><span class="nf">Append</span><span class="p">(</span><span class="n">inArray</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="nf">ToString</span><span class="p">(</span><span class="s">"X2"</span><span class="p">));</span>
               <span class="p">}</span>

               <span class="n">hmacmd</span><span class="p">.</span><span class="nf">Clear</span><span class="p">();</span>

               <span class="k">return</span> <span class="n">sb</span><span class="p">.</span><span class="nf">ToString</span><span class="p">().</span><span class="nf">ToLower</span><span class="p">();</span>
           <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span> <span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="kt">string</span> <span class="n">wsuri</span> <span class="p">=</span> <span class="s">"wss://push.trade-planets.com/cbu"</span><span class="p">;</span>
        <span class="kt">string</span> <span class="n">apikey</span> <span class="p">=</span> <span class="s">"900625568558820892a8c833c33ebc8fd2701efe"</span><span class="p">;</span>
        <span class="kt">string</span> <span class="n">secret</span> <span class="p">=</span> <span class="s">"c708ac3e70d115ec29efbee197330627d7edf842"</span><span class="p">;</span>

      <span class="k">using</span> <span class="p">(</span><span class="kt">var</span> <span class="n">ws</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">WebSocket</span> <span class="p">(</span><span class="n">wsuri</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">ws</span><span class="p">.</span><span class="n">OnMessage</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>

            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"recv: "</span> <span class="p">+</span> <span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">IsText</span><span class="p">)</span> <span class="p">{</span>
              <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"data[0]: {"</span><span class="p">);</span>

            <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">IsBinary</span><span class="p">)</span> <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">==</span> <span class="m">1</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"RawData[0]: 1"</span><span class="p">);</span>
                    <span class="kt">string</span> <span class="n">strres</span> <span class="p">=</span> <span class="nf">Decompress</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="n">strres</span><span class="p">);</span>

                <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">[</span><span class="m">0</span><span class="p">]</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="p">{</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="s">"RawData[0]: 0"</span><span class="p">);</span>
                    <span class="kt">string</span> <span class="n">strres</span> <span class="p">=</span> <span class="n">Encoding</span><span class="p">.</span><span class="n">ASCII</span><span class="p">.</span><span class="nf">GetString</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">RawData</span><span class="p">);</span>
                    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span> <span class="p">(</span><span class="n">strres</span><span class="p">);</span>

                <span class="p">}</span>
            <span class="p">}</span>

        <span class="p">};</span>

        <span class="n">ws</span><span class="p">.</span><span class="nf">Connect</span> <span class="p">();</span>

        <span class="kt">var</span> <span class="n">myparam</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
            <span class="n">apikey</span> <span class="p">=</span> <span class="n">apikey</span><span class="p">,</span>
            <span class="n">sub</span> <span class="p">=</span> <span class="s">"ALL_ALL_login"</span><span class="p">,</span>
        <span class="p">};</span>
        <span class="kt">string</span> <span class="n">myparamstr</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myparam</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>
        <span class="kt">string</span> <span class="n">sign</span> <span class="p">=</span> <span class="nf">HmacMD5</span><span class="p">(</span><span class="n">myparamstr</span><span class="p">,</span> <span class="n">secret</span><span class="p">);</span>


        <span class="kt">var</span> <span class="n">myobj</span> <span class="p">=</span> <span class="k">new</span> <span class="p">{</span>
            <span class="n">apikey</span> <span class="p">=</span> <span class="n">apikey</span><span class="p">,</span>
            <span class="n">sign</span> <span class="p">=</span> <span class="n">sign</span><span class="p">,</span>
            <span class="n">sub</span> <span class="p">=</span> <span class="s">"ALL_ALL_login"</span><span class="p">,</span>
        <span class="p">};</span>

        <span class="kt">string</span> <span class="n">payload</span> <span class="p">=</span> <span class="n">JsonConvert</span><span class="p">.</span><span class="nf">SerializeObject</span><span class="p">(</span><span class="n">myobj</span><span class="p">,</span> <span class="k">new</span> <span class="n">JsonSerializerSettings</span> <span class="p">{</span> <span class="n">ContractResolver</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">SortContractResolver</span><span class="p">()</span> <span class="p">});</span>

        <span class="n">ws</span><span class="p">.</span><span class="nf">Send</span> <span class="p">(</span><span class="n">payload</span><span class="p">);</span>

        <span class="n">ConsoleKey</span> <span class="n">key</span><span class="p">;</span>
        <span class="k">do</span>
    <span class="err">　　</span><span class="p">{</span>
    <span class="err">　　</span>      <span class="n">key</span><span class="p">=</span><span class="n">Console</span><span class="p">.</span><span class="nf">ReadKey</span><span class="p">().</span><span class="n">Key</span><span class="p">;</span>
    <span class="err">　　</span>
    <span class="err">　　</span><span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="n">key</span> <span class="p">!=</span> <span class="n">ConsoleKey</span><span class="p">.</span><span class="n">Q</span><span class="p">);</span>

      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

</code></pre></div>
<ul>
<li>1.Request path</li>
</ul>

<p>wss://push.trade-planets.com/cbu</p>

<ul>
<li>2.Request parameter</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Necessary or not</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
<th>Value Range</th>
</tr>
</thead><tbody>
<tr>
<td>apikey</td>
<td>true</td>
<td>string</td>
<td>your apikey</td>
<td></td>
<td></td>
</tr>
<tr>
<td>sign</td>
<td>true</td>
<td>string</td>
<td>sign</td>
<td></td>
<td></td>
</tr>
<tr>
<td>sub</td>
<td>true</td>
<td>string</td>
<td></td>
<td></td>
<td>&#39;ALL_ALL_login&#39;</td>
</tr>
</tbody></table>

<ul>
<li>3.Signature method</li>
</ul>

<p>1.Define the parameter object param, need to use apikey</p>

<p>let apikey = &#39;this is your apikey&#39;; </p>

<p>let param = {
     &quot;apikey&quot;: apikey,
     &quot;sub&quot;: &quot;ALL_ALL_login&quot;
   };</p>

<p>2.Format the parameter object param, get strParam</p>

<p>let strParam = JSON.stringify(param);</p>

<p>3.Use apikey&#39;s secret to sign strParam with HmacMD5, and get the signature result sign</p>

<p>let CryptoJS = require(&quot;crypto-js&quot;);</p>

<p>let secret = &#39;this is your apikey secret&#39;;</p>

<p>let sign = CryptoJS.HmacMD5(strParam, secret).toString();  </p>

<p>4.Generate subscription parameters wsparam</p>

<p>let wsparam = {
     &quot;apikey&quot;: apikey,
     &quot;sign&quot;: sign,
     &quot;sub&quot;: &quot;ALL_ALL_login&quot;,
    };</p>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"topic"</span><span class="p">:</span><span class="s2">"ALL_ALL_login"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"uid"</span><span class="p">:</span><span class="s2">"1000000"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"d"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"result"</span><span class="p">:</span><span class="s2">"订阅成功"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>4.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>result</td>
<td>&quot;订阅成功&quot; means subscription success</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='36-get-assets-from-subscribed-user-data'>36.Get assets from subscribed user data</h2>
<ul>
<li>1.Key field</li>
</ul>

<p>contract_assets or assets_all</p>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"topic"</span><span class="p">:</span><span class="s2">"ALL_ALL_login"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"uid"</span><span class="p">:</span><span class="s2">"10000"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"d"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"assets_all"</span><span class="p">:[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"ff"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"b"</span><span class="p">:</span><span class="s2">"2050.8565"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"c"</span><span class="p">:</span><span class="s2">"USDT"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1639123200000</span><span class="p">,</span><span class="w">
                </span><span class="nl">"u"</span><span class="p">:</span><span class="mi">11008936</span><span class="p">,</span><span class="w">
                </span><span class="nl">"v"</span><span class="p">:</span><span class="mi">62938352964</span><span class="p">,</span><span class="w">
                </span><span class="nl">"mc"</span><span class="p">:</span><span class="s2">"261.3161"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"mf"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"fc"</span><span class="p">:</span><span class="s2">"0"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="p">{</span><span class="w">
    </span><span class="nl">"topic"</span><span class="p">:</span><span class="s2">"ALL_ALL_login"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"uid"</span><span class="p">:</span><span class="s2">"100006"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"d"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"contract_assets"</span><span class="p">:{</span><span class="w">
            </span><span class="nl">"ff"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"b"</span><span class="p">:</span><span class="s2">"1862.4156"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"c"</span><span class="p">:</span><span class="s2">"USDT"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1639128405433</span><span class="p">,</span><span class="w">
            </span><span class="nl">"u"</span><span class="p">:</span><span class="mi">100006</span><span class="p">,</span><span class="w">
            </span><span class="nl">"v"</span><span class="p">:</span><span class="mi">108774606</span><span class="p">,</span><span class="w">
            </span><span class="nl">"mc"</span><span class="p">:</span><span class="s2">"130.6414"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"mf"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"fc"</span><span class="p">:</span><span class="s2">"6.0756"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>2.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>b</td>
<td>Available Balance</td>
</tr>
<tr>
<td>c</td>
<td>coin symbol</td>
</tr>
<tr>
<td>u</td>
<td>user id</td>
</tr>
<tr>
<td>ff</td>
<td>Fixed Position Frozen funds</td>
</tr>
<tr>
<td>fc</td>
<td>Cross Position Frozen funds</td>
</tr>
<tr>
<td>mf</td>
<td>Fixed Position margin</td>
</tr>
<tr>
<td>mc</td>
<td>Cross Position margin</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='37-get-position-from-subscribed-user-data'>37.Get position from subscribed user data</h2>
<ul>
<li>1.Key field</li>
</ul>

<p>contract_order or position_all</p>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"topic"</span><span class="p">:</span><span class="s2">"ALL_ALL_login"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"uid"</span><span class="p">:</span><span class="s2">"100006"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"d"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"position_all"</span><span class="p">:[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"pp"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"ps"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"pt"</span><span class="p">:</span><span class="s2">"-0.0886026273"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"sd"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
                </span><span class="nl">"ui"</span><span class="p">:</span><span class="mi">100006</span><span class="p">,</span><span class="w">
                </span><span class="nl">"md"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
                </span><span class="nl">"mg"</span><span class="p">:</span><span class="s2">"72.825"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"1125899906842624043"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"sp"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"ut"</span><span class="p">:</span><span class="mi">1639123200000</span><span class="p">,</span><span class="w">
                </span><span class="nl">"cc"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"st"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"f"</span><span class="p">:</span><span class="s2">"0.4344"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"l"</span><span class="p">:</span><span class="s2">"10"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"pa"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"pc"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1638177636516</span><span class="p">,</span><span class="w">
                </span><span class="nl">"fb0"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"v"</span><span class="p">:</span><span class="mi">108181199</span><span class="p">,</span><span class="w">
                </span><span class="nl">"pf"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"lc"</span><span class="p">:</span><span class="s2">"0.013"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"pi"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"hc"</span><span class="p">:</span><span class="s2">"0.013"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"fb"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"po"</span><span class="p">:</span><span class="s2">"55700.1923076923"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="p">{</span><span class="w">
    </span><span class="nl">"topic"</span><span class="p">:</span><span class="s2">"ALL_ALL_login"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"uid"</span><span class="p">:</span><span class="s2">"100006"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"d"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"contract_order"</span><span class="p">:{</span><span class="w">
            </span><span class="nl">"pp"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"ps"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pt"</span><span class="p">:</span><span class="s2">"-0.0886026273"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"sd"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"ui"</span><span class="p">:</span><span class="mi">100006</span><span class="p">,</span><span class="w">
            </span><span class="nl">"md"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"mg"</span><span class="p">:</span><span class="s2">"72.825"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"1125899906842624043"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"sp"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"ut"</span><span class="p">:</span><span class="mi">1639128405433</span><span class="p">,</span><span class="w">
            </span><span class="nl">"cc"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"st"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"f"</span><span class="p">:</span><span class="s2">"0.4344"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"l"</span><span class="p">:</span><span class="s2">"10"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pa"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pc"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1638177636516</span><span class="p">,</span><span class="w">
            </span><span class="nl">"fb0"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"v"</span><span class="p">:</span><span class="mi">108774604</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pf"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"lc"</span><span class="p">:</span><span class="s2">"0.013"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pi"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"hc"</span><span class="p">:</span><span class="s2">"0.013"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"fb"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"po"</span><span class="p">:</span><span class="s2">"55700.1923076923"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">


</span></code></pre></div>
<ul>
<li>2.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>l</td>
<td>leverage</td>
</tr>
<tr>
<td>sd</td>
<td>Position side, 1 Long, 2 Short</td>
</tr>
<tr>
<td>pa</td>
<td>Alert price</td>
</tr>
<tr>
<td>ui</td>
<td>user id</td>
</tr>
<tr>
<td>pf</td>
<td>Liquidation price</td>
</tr>
<tr>
<td>md</td>
<td>Position mode, 1 Cross, 2 Fixed</td>
</tr>
<tr>
<td>lc</td>
<td>Can liquidate position value</td>
</tr>
<tr>
<td>pi</td>
<td>pair</td>
</tr>
<tr>
<td>mg</td>
<td>margin</td>
</tr>
<tr>
<td>hc</td>
<td>Position value = Contract number multiplied by contract value</td>
</tr>
<tr>
<td>po</td>
<td>Open price</td>
</tr>
<tr>
<td>pp</td>
<td>Stop-profit quantity</td>
</tr>
<tr>
<td>ps</td>
<td>Stop-loss quantity</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='38-get-order-from-subscribed-user-data'>38.Get order from subscribed user data</h2>
<ul>
<li>1.Key field</li>
</ul>

<p>contract_pending or order_all</p>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"topic"</span><span class="p">:</span><span class="s2">"ALL_ALL_login"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"uid"</span><span class="p">:</span><span class="s2">"100006"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="nl">"d"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"order_all"</span><span class="p">:[</span><span class="w">
            </span><span class="p">{</span><span class="w">
                </span><span class="nl">"tt"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"tw"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"pw"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"dp"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"tif"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"sd"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bt"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"ui"</span><span class="p">:</span><span class="mi">100006</span><span class="p">,</span><span class="w">
                </span><span class="nl">"fz"</span><span class="p">:</span><span class="s2">"6.0756"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"of"</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="w">
                </span><span class="nl">"oi"</span><span class="p">:</span><span class="s2">"17592186044417"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"ot"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
                </span><span class="nl">"f"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"eq"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"p"</span><span class="p">:</span><span class="s2">"60000"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"q"</span><span class="p">:</span><span class="s2">"0.001"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"tpl"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"r"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"s"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
                </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1639128405433</span><span class="p">,</span><span class="w">
                </span><span class="nl">"pd"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"fb0"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"tl"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"pi"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"tpw"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"coi"</span><span class="p">:</span><span class="s2">"1639128409489"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"fb"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"pl"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"po"</span><span class="p">:</span><span class="kc">false</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span><span class="p">{</span><span class="w">
    </span><span class="nl">"topic"</span><span class="p">:</span><span class="s2">"ALL_ALL_login"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"uid"</span><span class="p">:</span><span class="s2">"100006"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"d"</span><span class="p">:{</span><span class="w">
        </span><span class="nl">"contract_pending"</span><span class="p">:{</span><span class="w">
            </span><span class="nl">"tt"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"tw"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pw"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"dp"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"tif"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"sd"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="nl">"bt"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"ui"</span><span class="p">:</span><span class="mi">100006</span><span class="p">,</span><span class="w">
            </span><span class="nl">"fz"</span><span class="p">:</span><span class="s2">"6.0756"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"of"</span><span class="p">:</span><span class="mi">6</span><span class="p">,</span><span class="w">
            </span><span class="nl">"oi"</span><span class="p">:</span><span class="s2">"17592186044417"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"ot"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
            </span><span class="nl">"f"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"eq"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"p"</span><span class="p">:</span><span class="s2">"60000"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"q"</span><span class="p">:</span><span class="s2">"0.001"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"tpl"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"r"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
            </span><span class="nl">"s"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
            </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1639128405433</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pd"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"fb0"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"tl"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pi"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"tpw"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"coi"</span><span class="p">:</span><span class="s2">"1639128409489"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"fb"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"pl"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"po"</span><span class="p">:</span><span class="kc">false</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div>
<ul>
<li>2.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>f</td>
<td>fee</td>
</tr>
<tr>
<td>dp</td>
<td>Deal price</td>
</tr>
<tr>
<td>eq</td>
<td>Deal amount</td>
</tr>
<tr>
<td>p</td>
<td>Order price</td>
</tr>
<tr>
<td>q</td>
<td>Order quantity</td>
</tr>
<tr>
<td>sd</td>
<td>Order side</td>
</tr>
<tr>
<td>r</td>
<td>Reason for failure</td>
</tr>
<tr>
<td>s</td>
<td>Order status</td>
</tr>
<tr>
<td>t</td>
<td>time</td>
</tr>
<tr>
<td>ui</td>
<td>user id</td>
</tr>
<tr>
<td>fz</td>
<td>Frozen funds</td>
</tr>
<tr>
<td>fb0</td>
<td>Coupon deduction</td>
</tr>
<tr>
<td>of</td>
<td>Order source</td>
</tr>
<tr>
<td>pi</td>
<td>pair</td>
</tr>
<tr>
<td>oi</td>
<td>order id</td>
</tr>
<tr>
<td>coi</td>
<td>Client order id</td>
</tr>
<tr>
<td>fb</td>
<td>Token deduction</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='39-get-deals-detail-from-subscribed-user-data'>39.Get deals detail from subscribed user data</h2>
<ul>
<li>1.Key field</li>
</ul>

<p>contract_detail</p>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"topic"</span><span class="p">:</span><span class="s2">"ALL_ALL_login"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"uid"</span><span class="p">:</span><span class="s2">"100006"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"d"</span><span class="p">:{</span><span class="w">
            </span><span class="nl">"contract_detail"</span><span class="p">:{</span><span class="w">
                </span><span class="nl">"oi"</span><span class="p">:</span><span class="s2">"432108069715999"</span><span class="p">,</span><span class="err">//Order</span><span class="w"> </span><span class="err">id</span><span class="w">
                </span><span class="nl">"ui"</span><span class="p">:</span><span class="s2">"100006"</span><span class="p">,</span><span class="err">//user</span><span class="w"> </span><span class="err">id</span><span class="w">
                </span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"1125899906842648855"</span><span class="p">,</span><span class="err">//deals</span><span class="w"> </span><span class="err">detail</span><span class="w"> </span><span class="err">id</span><span class="w">
                </span><span class="nl">"coi"</span><span class="p">:</span><span class="s2">"1602750117684"</span><span class="p">,</span><span class="err">//client</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">id</span><span class="w">
                </span><span class="nl">"pi"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="err">//pair</span><span class="w">
                </span><span class="nl">"sd"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="err">//</span><span class="w">
                </span><span class="nl">"s"</span><span class="p">:</span><span class="mi">3</span><span class="p">,</span><span class="err">//</span><span class="w">
                </span><span class="nl">"ot"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
                </span><span class="nl">"of"</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Order</span><span class="w"> </span><span class="err">source</span><span class="w">
                </span><span class="nl">"q"</span><span class="p">:</span><span class="s2">"1"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"p"</span><span class="p">:</span><span class="s2">"11692"</span><span class="p">,</span><span class="err">//Pending</span><span class="w"> </span><span class="err">order</span><span class="w"> </span><span class="err">price</span><span class="w">
                </span><span class="nl">"dp"</span><span class="p">:</span><span class="s2">"10655"</span><span class="p">,</span><span class="err">//Deal</span><span class="w"> </span><span class="err">price</span><span class="w">
                </span><span class="nl">"ep"</span><span class="p">:</span><span class="s2">"1"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"f"</span><span class="p">:</span><span class="s2">"0.0000000657"</span><span class="p">,</span><span class="err">//fee</span><span class="w">
                </span><span class="nl">"fb"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="err">//Token</span><span class="w"> </span><span class="err">deduction</span><span class="w">
                </span><span class="nl">"fb0"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="err">//Coupon</span><span class="w"> </span><span class="err">deduction</span><span class="w">
                </span><span class="nl">"im"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="err">//is</span><span class="w"> </span><span class="err">maker</span><span class="w">
                </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1602750121093</span><span class="p">,</span><span class="w"> </span><span class="err">//time</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">


</span></code></pre></div>
<ul>
<li>2.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>oi</td>
<td>order id</td>
</tr>
<tr>
<td>ui</td>
<td>user id</td>
</tr>
<tr>
<td>id</td>
<td>record id</td>
</tr>
<tr>
<td>coi</td>
<td>Client order id</td>
</tr>
<tr>
<td>pi</td>
<td>pair</td>
</tr>
<tr>
<td>sd</td>
<td>Order side</td>
</tr>
<tr>
<td>of</td>
<td>Order source</td>
</tr>
<tr>
<td>p</td>
<td>Order price</td>
</tr>
<tr>
<td>dp</td>
<td>Deal price</td>
</tr>
<tr>
<td>f</td>
<td>fee</td>
</tr>
<tr>
<td>fb0</td>
<td>Coupon deduction</td>
</tr>
<tr>
<td>fb</td>
<td>Token deduction</td>
</tr>
<tr>
<td>im</td>
<td>is maker</td>
</tr>
<tr>
<td>t</td>
<td>time</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='40-get-passive-changes-in-positions-from-subscribed-user-data'>40.Get passive changes in positions from subscribed user data</h2>
<ul>
<li>1.Key field</li>
</ul>

<p>contract_deal_log</p>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"topic"</span><span class="p">:</span><span class="s2">"ALL_ALL_login"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"uid"</span><span class="p">:</span><span class="s2">"100006"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"d"</span><span class="p">:{</span><span class="w">
            </span><span class="nl">"contract_deal_log"</span><span class="p">:{</span><span class="w">
                </span><span class="nl">"id"</span><span class="p">:</span><span class="s2">"1125899906842654296"</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">record</span><span class="w"> </span><span class="err">id</span><span class="w">
                </span><span class="nl">"user_id"</span><span class="p">:</span><span class="mi">100006</span><span class="p">,</span><span class="err">//user</span><span class="w"> </span><span class="err">id</span><span class="w">
                </span><span class="nl">"type"</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span><span class="err">//Change</span><span class="w"> </span><span class="err">type</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="err">open</span><span class="w"> </span><span class="err">position</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="err">close</span><span class="w"> </span><span class="err">position</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="err">lighten</span><span class="w"> </span><span class="err">position</span><span class="w"> </span><span class="err">to</span><span class="w"> </span><span class="err">reduce</span><span class="w"> </span><span class="err">risk</span><span class="w"> </span><span class="err">level</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="err">liquidate</span><span class="w"> </span><span class="err">position</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="err">ADL</span><span class="w">
                </span><span class="nl">"mode"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="err">//Position</span><span class="w"> </span><span class="err">model</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="err">Cross</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="err">Fixed</span><span class="w">
                </span><span class="nl">"pair"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="err">//pair</span><span class="w">
                </span><span class="nl">"price"</span><span class="p">:</span><span class="s2">"11247.6"</span><span class="p">,</span><span class="err">//proposed</span><span class="w"> </span><span class="err">price</span><span class="w">
                </span><span class="nl">"hold_dx"</span><span class="p">:</span><span class="s2">"1"</span><span class="p">,</span><span class="err">//Change</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="err">position</span><span class="w">
                </span><span class="nl">"order_side"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="err">//</span><span class="w"> </span><span class="err">Position</span><span class="w"> </span><span class="err">side</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="err">Long</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="err">Short</span><span class="w">
                </span><span class="nl">"time"</span><span class="p">:</span><span class="mi">1602755131000</span><span class="p">,</span><span class="w"> </span><span class="err">//time</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">


</span></code></pre></div>
<ul>
<li>2.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>record id</td>
</tr>
<tr>
<td>user_id</td>
<td>user id</td>
</tr>
<tr>
<td>type</td>
<td>Change type, 1 open position, 2 close position, 3 lighten position to reduce risk level, 4 liquidate position, 5ADL</td>
</tr>
<tr>
<td>mode</td>
<td>Position model, 1Cross, 2Fixed</td>
</tr>
<tr>
<td>pair</td>
<td>pair</td>
</tr>
<tr>
<td>price</td>
<td>proposed price</td>
</tr>
<tr>
<td>hold_dx</td>
<td>Change in position</td>
</tr>
<tr>
<td>order_side</td>
<td>Position side, 1Long, 2Short</td>
</tr>
<tr>
<td>time</td>
<td>time</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h2 id='41-get-stop-profit-stop-loss-order-from-subscribed-user-data'>41.Get Stop-profit Stop-loss Order from subscribed user data</h2>
<ul>
<li>1.Key field</li>
</ul>

<p>base_u_plan_order_v3</p>

<blockquote>
<p>Response</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"topic"</span><span class="p">:</span><span class="s2">"ALL_ALL_login"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"uid"</span><span class="p">:</span><span class="s2">"100006"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nl">"d"</span><span class="p">:{</span><span class="w">
            </span><span class="nl">"base_u_plan_order_v3"</span><span class="p">:{</span><span class="w">
                </span><span class="nl">"tt"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
                </span><span class="nl">"pr"</span><span class="p">:</span><span class="s2">"49900"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"pt"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
                </span><span class="nl">"pid"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"q"</span><span class="p">:</span><span class="s2">"0.001"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"sd"</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="w">
                </span><span class="nl">"r"</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bt"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
                </span><span class="nl">"s"</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="w">
                </span><span class="nl">"t"</span><span class="p">:</span><span class="mi">1638157434782</span><span class="p">,</span><span class="w">
                </span><span class="nl">"ui"</span><span class="p">:</span><span class="mi">100006</span><span class="p">,</span><span class="w">
                </span><span class="nl">"si"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"pi"</span><span class="p">:</span><span class="s2">"4BTC_USDT"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"oi"</span><span class="p">:</span><span class="s2">"5226915"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"bid"</span><span class="p">:</span><span class="s2">"0"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"tp"</span><span class="p">:</span><span class="s2">"49900"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"otd"</span><span class="p">:</span><span class="s2">"0"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">


</span></code></pre></div>
<ul>
<li>2.Response field description</li>
</ul>

<table><thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>oi</td>
<td>order id</td>
</tr>
<tr>
<td>pi</td>
<td>Contract symbol</td>
</tr>
<tr>
<td>pr</td>
<td>book price</td>
</tr>
<tr>
<td>tp</td>
<td>trigger price</td>
</tr>
<tr>
<td>q</td>
<td>book quantity</td>
</tr>
<tr>
<td>sd</td>
<td>Position side：1Long、2Short</td>
</tr>
<tr>
<td>pt</td>
<td>Stop-profit or Stop-loss：1Stop-profit、2Stop-loss</td>
</tr>
<tr>
<td>bt</td>
<td>market order or limit order：1market order，2limit order</td>
</tr>
<tr>
<td>s</td>
<td>order status：1wait trigger、2triggered、3canceled、4triggered failed、5canceled</td>
</tr>
<tr>
<td>Other fields</td>
<td>ignore</td>
</tr>
</tbody></table>
<h1 id='errors'>Errors</h1><h2 id='044106d39a'>エラーコード</h2>
<table><thead>
<tr>
<th>Code</th>
<th>説明する</th>
<th>Msg</th>
</tr>
</thead><tbody>
<tr>
<td>2003</td>
<td>Cookie 無効</td>
<td>Cookie expired</td>
</tr>
<tr>
<td>2033</td>
<td>操作に失敗しました！ 注文が完了またはキャンセルされました</td>
<td>Operation failed! Order completed or canceled</td>
</tr>
<tr>
<td>2034</td>
<td>操作に失敗しました！ パラメータが正しいかどうかを確認してください</td>
<td>Operation failed! Please check parameter</td>
</tr>
<tr>
<td>2040</td>
<td>操作に失敗しました！ そんな順番はないよ</td>
<td>Operation failed! No record</td>
</tr>
<tr>
<td>2064</td>
<td>注文はキャンセルされており、再度キャンセルすることはできません</td>
<td>Canceling. Unable to cancel again</td>
</tr>
<tr>
<td>2065</td>
<td>注文価格の設定が高すぎます。価格をリセットしてください</td>
<td>Precatory price is exorbitant, please reset</td>
</tr>
<tr>
<td>2066</td>
<td>注文価格の設定が低すぎます。価格をリセットしてください</td>
<td>Precatory price is low , please reset</td>
</tr>
<tr>
<td>2067</td>
<td>成行注文は現在サポートされていません</td>
<td>Limit Order Only</td>
</tr>
<tr>
<td>2068</td>
<td>注文数量は 0.0001 未満にすることはできません</td>
<td>Min Amount:0.0001</td>
</tr>
<tr>
<td>2078</td>
<td>注文価格が不正です</td>
<td>unvalid order price</td>
</tr>
<tr>
<td>2085</td>
<td>通貨の最低注文数量制限</td>
<td>the trade amount is low</td>
</tr>
<tr>
<td>2086</td>
<td>異常な口座資産、注文制限</td>
<td>Abnormal account assets, trade is forbiden</td>
</tr>
<tr>
<td>2091</td>
<td>リクエストが多すぎます。後でもう一度お試しください。</td>
<td>request is too frequency, please try again later</td>
</tr>
<tr>
<td>2092</td>
<td>通貨の最低注文金額制限</td>
<td>Minimum amount not met</td>
</tr>
<tr>
<td>3000</td>
<td>リクエストパラメータエラー</td>
<td>Requested parameter incorrect</td>
</tr>
<tr>
<td>3002</td>
<td>パラメータを空にすることはできません</td>
<td>Parameter cannot be null</td>
</tr>
<tr>
<td>3010</td>
<td>websocket接続異常</td>
<td>websocket connection error</td>
</tr>
<tr>
<td>3011</td>
<td>インターフェイスは apikey リクエスト メソッドをサポートしていません</td>
<td>Illegal subscribe event</td>
</tr>
<tr>
<td>3012</td>
<td>apikey無効</td>
<td>Interface does not support apikey request method</td>
</tr>
<tr>
<td>3016</td>
<td>取引ペアエラー</td>
<td>Invalid apikey</td>
</tr>
<tr>
<td>3024</td>
<td>apikey権限が不十分です</td>
<td>apikey authorization insufficient</td>
</tr>
<tr>
<td>3025</td>
<td>apikey署名の検証に失敗しました</td>
<td>apikey signature verification failed</td>
</tr>
<tr>
<td>3026</td>
<td>apikey ip制限付き</td>
<td>apikey ip is restricted</td>
</tr>
<tr>
<td>3027</td>
<td>アカウントがありませんapikey</td>
<td>No apikey in your account</td>
</tr>
<tr>
<td>3028</td>
<td>アカウント APIKEY の数が制限を超えています</td>
<td>Account apikey has exceeded the limit amount</td>
</tr>
<tr>
<td>3029</td>
<td>apikey で許可される IP の数が制限を超えています</td>
<td>apikey ip has exceeded the limit amount</td>
</tr>
<tr>
<td>4000</td>
<td>現在のネットワーク接続は不安定です。後でもう一度お試しください。</td>
<td>the network is unstable now, please try again later</td>
</tr>
<tr>
<td>4003</td>
<td>サーバーがビジーです。後でもう一度お試しください。</td>
<td>The server is busy, please try again later</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="javascript">javascript</a>
                <a href="#" data-language-name="python">python</a>
                <a href="#" data-language-name="csharp">csharp</a>
          </div>
      </div>
    </div>
  </body>
      <script>
        const lang_btn1 = document.getElementById('lang_box1');
        const lang_btn2 = document.getElementById('lang_box2');
        const spot_class = document.getElementById('spot-class-current');
        const future_class = document.getElementById('future-class-current');
        const spot_txt = document.getElementById('spot-txt');
        const future_txt = document.getElementById('future-txt');
        const biboxLogo = document.getElementById('trade-planet-logo')

        const url = GetUrlRelativePath();

        if(url.indexOf('en') != -1){
          //英文
          spot_txt.innerHTML = 'Spot'
          spot_txt.href = spot_txt.href.replace('zh/', 'en/');
          future_txt.innerHTML = 'USDT-M'
          future_txt.href=future_txt.href.replace('zh/', 'en/');
          lang_btn1.innerHTML = '日本語'
          lang_btn1.href=url.replace('en/', 'ja/');
          lang_btn2.innerHTML = '简体中文'
          lang_btn2.href=url.replace('en/', 'zh/');
          biboxLogo.onclick = function () {
            window.location.href = 'https://www.trade-planets.com/en'
          }
        } else if (url.indexOf('ja') != -1) {
          //日文
          spot_txt.innerHTML = '現物取引'
          spot_txt.href = spot_txt.href.replace('zh/', 'ja/');
          future_txt.innerHTML = 'U本位永続契約'
          future_txt.href=future_txt.href.replace('zh/', 'ja/');
          lang_btn1.innerHTML = '简体中文'
          lang_btn1.href=url.replace('ja/', 'zh/');
          lang_btn2.innerHTML = 'English'
          lang_btn2.href=url.replace('ja/', 'en/');
          biboxLogo.onclick = function () {
            window.location.href = 'https://www.trade-planets.com/ja'
          }
        } else {
          //中文
          spot_txt.innerHTML = '现货'
          spot_txt.href = spot_txt.href.replace('zh/', 'zh/');
          future_txt.innerHTML = 'U本位永续合约'
          future_txt.href = future_txt.href.replace('zh/', 'zh/');
          lang_btn1.innerHTML = '日本語'
          lang_btn1.href=url.replace('zh/', 'ja/');
          lang_btn2.innerHTML = 'English'
          lang_btn2.href=url.replace('zh/', 'en/');
          biboxLogo.onclick = function () {
            window.location.href = 'https://www.trade-planets.com/zh'
          }
        }

        if(location.href.indexOf('/spot/') > 0){
          spot_class.className = 'nav-select current';
        } else if(location.href.indexOf('/futures/') > 0){
          future_class.className = 'nav-select current';
        }
        function GetUrlRelativePath(){
          let url = document.location.toString();
          let arrUrl = url.split("//");
          let start = arrUrl[1].indexOf("/");
          let relUrl = arrUrl[1].substring(start);
          if(relUrl.indexOf("?") != -1){
            relUrl = relUrl.split("?")[0];
          }
          if(relUrl.indexOf("#") != -1){
            relUrl = relUrl.split("#")[0];
          }
          return relUrl;
    　　}
      </script>
</html>
